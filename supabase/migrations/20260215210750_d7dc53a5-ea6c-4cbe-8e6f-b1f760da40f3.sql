
-- ============================================================
-- TENANT ISOLATION PHASE 1: Vollst채ndige H채rtung
-- ============================================================
-- Block 1: Alle dev_mode Policies entfernen (18 St체ck)
-- Block 2: RESTRICTIVE tenant_id Isolation f체r alle 180 Tabellen
-- ============================================================

-- ===================== BLOCK 1: DROP dev_mode =====================

DROP POLICY IF EXISTS "applicant_profiles_select_dev_mode" ON public.applicant_profiles;
DROP POLICY IF EXISTS "applicant_insert_dev_mode" ON public.applicant_profiles;
DROP POLICY IF EXISTS "contacts_select_dev_mode" ON public.contacts;
DROP POLICY IF EXISTS "context_members_select_dev_mode" ON public.context_members;
DROP POLICY IF EXISTS "document_links_select_dev_mode" ON public.document_links;
DROP POLICY IF EXISTS "documents_select_dev_mode" ON public.documents;
DROP POLICY IF EXISTS "finance_requests_select_dev_mode" ON public.finance_requests;
DROP POLICY IF EXISTS "landlord_contexts_select_dev_mode" ON public.landlord_contexts;
DROP POLICY IF EXISTS "leases_select_dev_mode" ON public.leases;
DROP POLICY IF EXISTS "loans_select_dev_mode" ON public.loans;
DROP POLICY IF EXISTS "org_select_dev_mode" ON public.organizations;
DROP POLICY IF EXISTS "prop_select_dev_mode" ON public.properties;
DROP POLICY IF EXISTS "prop_insert_dev_mode" ON public.properties;
DROP POLICY IF EXISTS "property_financing_select_dev_mode" ON public.property_financing;
DROP POLICY IF EXISTS "storage_nodes_select_dev_mode" ON public.storage_nodes;
DROP POLICY IF EXISTS "storage_insert_dev_mode" ON public.storage_nodes;
DROP POLICY IF EXISTS "units_select_dev_mode" ON public.units;
DROP POLICY IF EXISTS "unit_insert_dev_mode" ON public.units;

-- ===================== BLOCK 2: RESTRICTIVE tenant isolation =====================

CREATE POLICY "tenant_isolation_restrictive" ON public.access_grants AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.acq_inbound_messages AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.acq_mandate_events AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.acq_mandates AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.acq_offer_activities AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.acq_offer_documents AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.acq_offers AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.acq_outbound_messages AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.ad_campaigns AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.analytics_budget_settings AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.analytics_category_overrides AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.analytics_notes AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.applicant_liabilities AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.applicant_profiles AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.applicant_property_assets AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.armstrong_command_events AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.bank_account_meta AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.bank_transactions AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.billing_usage AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.calendar_events AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.cars_claims AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.cars_financing AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.cars_insurances AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.cars_logbook_connections AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.cars_offers AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.cars_trips AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.cars_vehicles AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.case_events AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.cases AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.commissions AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.consumer_loan_cases AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.contact_candidates AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.contact_conversations AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.contact_staging AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.contacts AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.context_members AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.context_property_assignment AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.contract_candidates AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.credibility_flags AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.credit_ledger AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.customer_projects AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.data_event_ledger AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.dev_project_documents AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.dev_project_reservations AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.dev_project_units AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.dev_projects AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.developer_contexts AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.document_checklist_items AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.document_chunks AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.document_links AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.document_reminders AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.documents AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.dossier_research_jobs AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.extractions AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.finance_cases AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.finance_documents AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.finance_mandates AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.finance_packages AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.finance_requests AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.finance_submission_logs AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.hosting_contracts AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.household_persons AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.inbound_attachments AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.inbound_emails AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.inbound_mailboxes AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.inbox_sort_containers AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.inbox_sort_rules AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.insurance_contract_links AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.insurance_contracts AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.integration_registry AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.investment_favorites AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.investment_profiles AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.investment_searches AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.invoices AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.landlord_contexts AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.lead_activities AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.lead_assignments AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.leads AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.leases AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.legal_documents AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.letter_drafts AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.listing_activities AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.listing_inquiries AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.listing_partner_terms AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.listing_publications AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.listing_views AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.listings AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.loans AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.mail_accounts AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.meeting_sessions AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.memberships AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.meters AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.miety_contracts AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.miety_eufy_accounts AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.miety_homes AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.miety_meter_readings AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.msv_action_notes AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.msv_bank_accounts AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.msv_book_values AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.msv_bwa_entries AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.msv_communication_prefs AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.msv_enrollments AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.msv_readiness_items AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.msv_rent_payments AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.msv_templates AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.nk_cost_items AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.nk_periods AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.nk_tenant_settlements AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.partner_deals AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.partner_listing_selections AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.partner_pipelines AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.pension_records AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.postings AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.postservice_mandates AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.properties AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.property_accounting AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.property_features AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.property_financing AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.property_valuations AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.pv_connectors AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.pv_measurements AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.pv_plants AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.rate_limit_counters AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.rent_payments AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.rent_reminders AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.rental_listings AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.rental_publications AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.renter_invites AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.research_billing_log AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.research_order_results AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.research_orders AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.research_results AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.research_sessions AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.reservations AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.sale_transactions AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.sales_desk_requests AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.scan_runs AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.scraper_jobs AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.scraper_results AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.self_disclosures AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.service_case_inbound AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.service_case_offers AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.service_case_outbound AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.service_case_providers AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.service_cases AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.social_assets AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.social_campaigns AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.social_creatives AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.social_drafts AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.social_inbound_items AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.social_inspiration_samples AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.social_inspiration_sources AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.social_leads AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.social_mandates AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.social_metrics AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.social_personality_profiles AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.social_templates AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.social_topics AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.social_video_jobs AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.storage_nodes AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.subscriptions AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.task_widgets AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.tenant_extraction_settings AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.tenant_tile_activation AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.tenant_websites AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.test_data_registry AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.units AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.user_consents AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.user_subscriptions AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.valuation_credits AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.video_calls AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.vorsorge_contracts AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.website_pages AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.website_sections AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.website_versions AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.whatsapp_accounts AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.whatsapp_attachments AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.whatsapp_conversations AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.whatsapp_messages AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
CREATE POLICY "tenant_isolation_restrictive" ON public.whatsapp_user_settings AS RESTRICTIVE FOR ALL TO authenticated USING (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid())) WITH CHECK (tenant_id = public.get_user_tenant_id() OR public.is_platform_admin(auth.uid()));
