{
  "version": "1.1",
  "created_at": "2026-02-15",
  "updated_at": "2026-02-15",
  "title": "Engine Consolidation Backlog",
  "description": "Schrittweiser Plan zur Konsolidierung aller verbleibenden Inline-Businesslogik in die Engine-Schicht (src/engines/). Jeder Eintrag beschreibt ein konkretes Refactoring-Ziel.",

  "status_legend": {
    "done": "Engine existiert UND Consumer nutzt sie",
    "engine_ready": "Engine existiert, Consumer nutzt noch Inline-Logik",
    "todo": "Noch nicht implementiert"
  },

  "engines": [
    {
      "id": "ENG-01",
      "name": "Akquise-Kalkulation",
      "path": "src/engines/akquiseCalc/",
      "status": "done",
      "consumers_refactored": [
        "BestandCalculation.tsx",
        "AufteilerCalculation.tsx",
        "QuickCalcTool.tsx",
        "ProjectAufteilerCalculation.tsx"
      ],
      "open_items": []
    },
    {
      "id": "ENG-02",
      "name": "Finanzierung",
      "path": "src/engines/finanzierung/",
      "status": "done",
      "consumers_refactored": [
        "useSubmitFinanceRequest.ts → createApplicantSnapshot()",
        "FMFallDetail.tsx → calcAnnuity()",
        "FutureRoomBonitat.tsx → calcAnnuity() + calcHaushaltsrechnung()",
        "useConsumerLoan.ts → re-exports calcConsumerLoanOffers()",
        "SelbstauskunftFormV2.tsx → calcCompletionScore() pattern",
        "AnfrageFormV2.tsx → FINANZIERUNG_DEFAULTS.minCompletionScore"
      ],
      "open_items": [
        { "id": "ENG-02-A", "status": "done", "title": "FutureRoomBonitat: Haushaltsrechnung" },
        { "id": "ENG-02-B", "status": "done", "title": "useConsumerLoan: Engine re-export" },
        { "id": "ENG-02-C", "status": "done", "title": "SelbstauskunftFormV2: calcCompletionScore()" },
        { "id": "ENG-02-D", "status": "done", "title": "AnfrageFormV2: minCompletionScore Konstante" }
      ]
    },
    {
      "id": "ENG-03",
      "name": "Provision",
      "path": "src/engines/provision/",
      "status": "done",
      "consumers_refactored": [
        "NetworkTab.tsx → aggregateCommissions()",
        "ProvisionenUebersicht.tsx → aggregateCommissions()",
        "CommissionApproval.tsx → aggregateCommissions()",
        "LeadDesk.tsx → aggregateCommissions()"
      ],
      "open_items": [
        { "id": "ENG-03-A", "status": "done", "title": "NetworkTab: Provisions-Aggregation" },
        { "id": "ENG-03-B", "status": "done", "title": "ProvisionenUebersicht: Provisions-Aggregation" },
        { "id": "ENG-03-C", "status": "done", "title": "VorgaengeTab: Nur Darstellung, kein Inline-Calc" },
        { "id": "ENG-03-D", "status": "done", "title": "CommissionApproval + LeadDesk: aggregateCommissions()" },
        { "id": "ENG-03-E", "status": "skipped", "title": "useProjectReservations: simple reduce, no engine needed" }
      ]
    },
    {
      "id": "ENG-04",
      "name": "Bewirtschaftung / BWA",
      "path": "src/engines/bewirtschaftung/",
      "status": "engine_ready",
      "consumers_refactored": [],
      "open_items": [
        { "id": "ENG-04-A", "status": "deferred", "title": "MOD-04 BWA-Tab: Wird bei Tab-Implementierung eingebunden" },
        { "id": "ENG-04-B", "status": "skipped", "title": "PropertyResearchTool: Nur Anzeige, kein Inline-Calc" },
        { "id": "ENG-04-C", "status": "skipped", "title": "AnalysisTab: Nur Anzeige, kein Inline-Calc" }
      ]
    },
    {
      "id": "ENG-05",
      "name": "Projekt-Kalkulation",
      "path": "src/engines/projektCalc/",
      "status": "done",
      "consumers_refactored": [
        "ProjectDetailPage.tsx → calcProjektKalkulation()",
        "projekte/types.ts → calcAufteilerQuick()",
        "LandingPageTab.tsx → PROJEKTCALC_DEFAULTS.defaultProvisionPercent"
      ],
      "open_items": [
        { "id": "ENG-05-A", "status": "done", "title": "ProjectDetailPage: Engine-Kalkulation" },
        { "id": "ENG-05-B", "status": "done", "title": "LandingPageTab: Provision über DEFAULTS" },
        { "id": "ENG-05-C", "status": "skipped", "title": "ProjektLandingPage: Nutzt commission_amount direkt, kein Fallback nötig" },
        { "id": "ENG-05-D", "status": "skipped", "title": "SalesStatusReportWidget: KPIs aus props, kein Inline-Calc" }
      ]
    }
  ],

  "cross_cutting_items": [
    {
      "id": "CROSS-01",
      "status": "done",
      "title": "Engine-Typen als Re-Export in src/engines/index.ts",
      "description": "Alle 6 Engines korrekt re-exportiert, keine zirkulaeren Abhaengigkeiten."
    },
    {
      "id": "CROSS-02",
      "priority": "low",
      "status": "todo",
      "title": "Unit-Tests fuer alle Engine-Funktionen",
      "description": "Reine Funktionen — ideale Kandidaten fuer Vitest-Unit-Tests."
    },
    {
      "id": "CROSS-03",
      "priority": "low",
      "status": "todo",
      "title": "Edge Function Nutzung vorbereiten",
      "description": "Engines muessen in Deno-Edge-Functions importierbar sein."
    }
  ],

  "summary": {
    "total_engines": 5,
    "done": 4,
    "engine_ready": 1,
    "open_refactoring_items": 0,
    "skipped_items": 5,
    "deferred_items": 1,
    "remaining_cross_cutting": 2
  }
}