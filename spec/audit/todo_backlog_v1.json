{
  "backlog_version": "1.0",
  "created_date": "2026-02-16",
  "total_items": 14,
  "summary": {
    "P1_critical": 1,
    "P2_important": 3,
    "P3_nice_to_have": 6,
    "P4_future_integration": 4,
    "demo_migration_plan": "included"
  },
  "items": [
    {
      "id": "TODO-001",
      "severity": "P1",
      "module": "MOD-04",
      "file": "src/engines/nkAbrechnung/engine.ts",
      "line": "169-171",
      "title": "NK-Engine: Hardcoded Personenzahlen",
      "description": "unitPersons=2, totalPersons=units*2, totalUnits fallback auf 10. Erfordert neue DB-Spalten: leases.number_of_occupants, properties.total_occupants.",
      "fix_type": "db_migration + code",
      "demo_impact": false,
      "effort": "medium"
    },
    {
      "id": "TODO-002",
      "severity": "P2",
      "module": "MOD-04",
      "file": "src/components/portfolio/NKAbrechnungTab.tsx",
      "line": "89",
      "title": "NK-Vorauszahlung: Hardcoded 12 Monate",
      "description": "Bei unterjährigen Mietverträgen sollte anteilig berechnet werden.",
      "fix_type": "code",
      "demo_impact": false,
      "effort": "low"
    },
    {
      "id": "TODO-003",
      "severity": "P2",
      "module": "MOD-18",
      "file": "src/hooks/useVVSteuerData.ts",
      "line": "138",
      "title": "VV-Steuer: NK-Nachzahlung fehlt",
      "description": "nkNachzahlung ist hardcoded 0 — sollte aus nk_tenant_settlements gelesen werden.",
      "fix_type": "code",
      "demo_impact": false,
      "effort": "medium"
    },
    {
      "id": "TODO-004",
      "severity": "P2",
      "module": "MOD-18",
      "file": "src/components/vv/VVAnlageVForm.tsx",
      "line": "87",
      "title": "Anlage V: Wohnfläche fehlt",
      "description": "areaSqm ist null — sollte aus units Tabelle gelesen werden.",
      "fix_type": "code",
      "demo_impact": false,
      "effort": "low"
    },
    {
      "id": "TODO-005",
      "severity": "P3",
      "module": "Armstrong",
      "file": "src/hooks/useArmstrongContext.ts",
      "line": "213-214",
      "title": "webResearchEnabled hardcoded true",
      "description": "Feature-Toggle für Web Research fehlt. Erfordert org_settings Spalte.",
      "fix_type": "db_migration + code",
      "demo_impact": false,
      "effort": "low"
    },
    {
      "id": "TODO-006",
      "severity": "P3",
      "module": "Z1-Acquiary",
      "file": "src/pages/admin/Acquiary.tsx",
      "line": "61",
      "title": "needsRoutingCount hardcoded 0",
      "description": "Sollte echte Query auf acq_inbound_messages.needs_routing nutzen.",
      "fix_type": "code",
      "demo_impact": false,
      "effort": "low"
    },
    {
      "id": "TODO-007",
      "severity": "P3",
      "module": "Z1-FinanceDesk",
      "file": "src/pages/admin/desks/FinanceDesk.tsx",
      "line": "26",
      "title": "FinanceDesk KPIs sind Mock-Daten",
      "description": "MOCK_KPIS sollten durch live Queries auf leads/finance_requests ersetzt werden.",
      "fix_type": "code",
      "demo_impact": false,
      "effort": "medium"
    },
    {
      "id": "TODO-008",
      "severity": "P3",
      "module": "MOD-04",
      "file": "src/components/portal/immobilien/sanierung/inbound/OffersComparisonPanel.tsx",
      "line": "216",
      "title": "Angebot-Betrag speichern nicht implementiert",
      "description": "Save offer amount Funktion fehlt im OffersComparisonPanel.",
      "fix_type": "code",
      "demo_impact": false,
      "effort": "low"
    },
    {
      "id": "TODO-009",
      "severity": "P3",
      "module": "MOD-04",
      "file": "src/components/portal/immobilien/sanierung/scope/DMSDocumentSelector.tsx",
      "line": "245",
      "title": "DMS Dokument-Preview nicht implementiert",
      "description": "Preview-Button hat keine Funktionalität.",
      "fix_type": "code",
      "demo_impact": false,
      "effort": "medium"
    },
    {
      "id": "TODO-010",
      "severity": "P3",
      "module": "MOD-04",
      "file": "src/hooks/useNKAbrechnung.ts",
      "line": "134,147,206,227,242,269,288,296,397,448",
      "title": "NK-Hook: 10x (supabase as any) Type-Casts",
      "description": "nk_periods und nk_cost_items fehlen in auto-generierten Typen. types.ts ist read-only — nicht fixbar ohne DB-Sync.",
      "fix_type": "infrastructure",
      "demo_impact": false,
      "effort": "none_possible"
    },
    {
      "id": "TODO-011",
      "severity": "P4",
      "module": "MOD-07",
      "file": "src/services/europace/consumerLoanAdapter.ts",
      "line": "9,14",
      "title": "Europace Consumer Loan API Stub",
      "description": "Europace-Integration noch nicht angebunden. Stub wirft Fehler.",
      "fix_type": "integration",
      "demo_impact": false,
      "effort": "high"
    },
    {
      "id": "TODO-012",
      "severity": "P4",
      "module": "MOD-11",
      "file": "src/pages/portal/finanzierungsmanager/FMInvestmentTab.tsx",
      "line": "14",
      "title": "Upvest-Integration Stub",
      "description": "Investment-Tab zeigt Empty State. Upvest API noch nicht angebunden.",
      "fix_type": "integration",
      "demo_impact": false,
      "effort": "high"
    },
    {
      "id": "TODO-013",
      "severity": "P4",
      "module": "MOD-04",
      "file": "src/hooks/useNKAbrechnung.ts",
      "line": "all",
      "title": "NK-Abrechnung: Vollständige DB-Typisierung",
      "description": "Sobald nk_periods/nk_cost_items in types.ts erscheinen, können alle as-any Casts entfernt werden.",
      "fix_type": "infrastructure",
      "demo_impact": false,
      "effort": "low_when_available"
    },
    {
      "id": "TODO-014",
      "severity": "P4",
      "module": "SYSTEM",
      "file": "src/engines/demoData/data.ts",
      "line": "all",
      "title": "Demo-Daten-Migration: Client → DB",
      "description": "KV/Vorsorge/Abonnement-Daten werden derzeit client-seitig in der Demo-Engine generiert. Migration in DB-Tabellen ermöglicht RLS-gestützte Filterung und vereinfacht die Engine.",
      "fix_type": "db_migration + refactor",
      "demo_impact": true,
      "effort": "high",
      "migration_plan": {
        "phase_1": "Tabellen erstellen: insurance_contracts, pension_contracts, subscriptions",
        "phase_2": "Demo-Daten als Seed-Skript in DB einfügen",
        "phase_3": "Hooks umbauen: statt client-seitige Generierung → Supabase Query",
        "phase_4": "isDemoId()-Prüfungen durch RLS tenant_id Filter ersetzen",
        "prerequisite": "Stabile Tabellen-Schemata für Versicherung/Vorsorge/Abonnements",
        "recommended_timing": "Nach Fertigstellung der MOD-07/MOD-11 Feature-Specs"
      }
    }
  ]
}
