/**
 * ARMSTRONG MANIFEST — SINGLE SOURCE OF TRUTH (V2)
 * 
 * Phase 6 Governance Schema with execution_mode, side_effects, and versioning.
 * Defines all Armstrong actions, their permissions, zones, and billing metadata.
 * 
 * RULES:
 * 1. All actions must be declared here
 * 2. Zone field determines availability (Z2 = Portal, Z3 = Websites)
 * 3. execution_mode determines confirmation requirements (K3 compliant)
 * 4. Changes require explicit approval + version bump
 * 
 * K3 ENFORCEMENT:
 * - execution_mode='execute' only allowed if: risk_level='low' AND cost_model='free'
 *   AND (data_scopes_write=[] OR writes are internal-only, e.g. ['widgets'])
 * - Interne Widget-Writes gelten NICHT als schutzbeduerftiger Schreibzugriff (keine externen Konsequenzen)
 * 
 * K4 ENFORCEMENT:
 * - execution_mode='draft_only' must not write to SSOT tables directly
 */

import type {
  ArmstrongActionV2,
  ArmstrongZone,
  ExecutionMode,
  RiskLevel,
  CostModel,
  CostUnit,
  ActionStatus,
  validateAllActions,
} from '@/types/armstrong';

// Re-export types for backwards compatibility
export type { ArmstrongActionV2, ArmstrongZone, ExecutionMode, RiskLevel, CostModel };

// Legacy type alias for gradual migration
export type ArmstrongAction = ArmstrongActionV2;

// =============================================================================
// TOP 30 MVP ACTION CODES (Phase 6 Content Blueprints)
// =============================================================================

/**
 * TOP_30_MVP_ACTION_CODES — Core set of 30 actions for MVP.
 * Selected based on:
 * - Essential functionality coverage (Packs A-F, H)
 * - K3/K4 compliance verified
 * - Cost model validated
 */
export const TOP_30_MVP_ACTION_CODES = [
  // Pack A: Core (6)
  'ARM.GLOBAL.EXPLAIN_TERM',
  'ARM.GLOBAL.FAQ',
  'ARM.GLOBAL.HOW_IT_WORKS',
  'ARM.GLOBAL.WEB_SEARCH',
  'ARM.GLOBAL.SUMMARIZE_TEXT',
  'ARM.GLOBAL.DRAFT_MESSAGE',
  
  // Pack B: Dashboard (5)
  'ARM.MOD00.CREATE_TASK',
  'ARM.MOD00.CREATE_REMINDER',
  'ARM.MOD00.CREATE_NOTE',
  'ARM.MOD00.CREATE_IDEA',
  'ARM.MOD00.CREATE_PROJECT',
  
  // Pack C: DMS (4)
  'ARM.MOD03.SEARCH_DOC',
  'ARM.MOD03.EXPLAIN_UPLOAD',
  'ARM.MOD03.LINK_DOC',
  'ARM.MOD03.EXTRACT_DOC',
  
  // Pack D: Immobilien (6)
  'ARM.MOD04.EXPLAIN_MODULE',
  'ARM.MOD04.VALIDATE_PROPERTY',
  'ARM.MOD04.CREATE_PROPERTY',
  'ARM.MOD04.CREATE_UNIT',
  'ARM.MOD04.CALCULATE_KPI',
  'ARM.MOD04.DATA_QUALITY_CHECK',
  
  // Pack E: Finanzierung (4)
  'ARM.MOD07.EXPLAIN_SELBSTAUSKUNFT',
  'ARM.MOD07.DOC_CHECKLIST',
  'ARM.MOD07.PREPARE_EXPORT',
  'ARM.MOD07.VALIDATE_READINESS',
  
  // Pack F: Investment (4)
  'ARM.MOD08.ANALYZE_FAVORITE',
  'ARM.MOD08.RUN_SIMULATION',
  'ARM.MOD08.CREATE_MANDATE',
  'ARM.MOD08.WEB_RESEARCH',
  
  // Pack H: KB (1)
  'ARM.KB.CREATE_RESEARCH_MEMO',
  
  // Pack I: Projekte (2)
  'ARM.MOD13.CREATE_DEV_PROJECT',
  'ARM.MOD13.EXPLAIN_MODULE',
  
  // Pack K: Communication Pro / Recherche (1)
  'ARM.MOD14.CREATE_RESEARCH_ORDER',
  
  // Pack J: Landing Page (1) — module-specific
  'ARM.LP.GENERATE_LANDING_PAGE',
] as const;

export type Top30MvpActionCode = typeof TOP_30_MVP_ACTION_CODES[number];

/**
 * Check if action is in Top 30 MVP set
 */
export function isTop30MvpAction(actionCode: string): boolean {
  return TOP_30_MVP_ACTION_CODES.includes(actionCode as Top30MvpActionCode);
}

// =============================================================================
// ZONE 3 ALLOWED ACTIONS (Public/Unauthenticated)
// =============================================================================

export const ZONE3_ALLOWED_ACTION_CODES = [
  // --- Shared: Explanations ---
  'ARM.GLOBAL.EXPLAIN_TERM',
  'ARM.GLOBAL.FAQ',
  
  // --- Shared: Public Calculators ---
  'ARM.PUBLIC.RENDITE_RECHNER',
  'ARM.PUBLIC.TILGUNG_RECHNER',
  'ARM.PUBLIC.BELASTUNG_RECHNER',
  
  // --- Shared: Lead Capture ---
  'ARM.PUBLIC.CONTACT_REQUEST',
  'ARM.PUBLIC.NEWSLETTER_SIGNUP',
  
  // --- Shared: Listing Info ---
  'ARM.PUBLIC.EXPLAIN_LISTING',
  'ARM.PUBLIC.COMPARE_LISTINGS',

  // --- Coach Lifecycle (5) ---
  'ARM.INV.COACH.AUTO_START',
  'ARM.INV.COACH.DISMISS',
  'ARM.INV.COACH.RESUME',
  'ARM.INV.COACH.PAUSE_FOR_USER',
  'ARM.INV.COACH.TO_SIMULATION',

  // --- Coach Slide Actions (28) ---
  ...(Array.from({ length: 8 }, (_, i) => `ARM.INV.COACH.VERKAUF.S${i+1}`) as string[]),
  ...(Array.from({ length: 7 }, (_, i) => `ARM.INV.COACH.RENDITE.S${i+1}`) as string[]),
  ...(Array.from({ length: 6 }, (_, i) => `ARM.INV.COACH.STEUER.S${i+1}`) as string[]),
  ...(Array.from({ length: 7 }, (_, i) => `ARM.INV.COACH.SOFT.S${i+1}`) as string[]),

  // --- Coach Engine Actions (8) ---
  'ARM.INV.COACH.ENGINE.INTRO',
  'ARM.INV.COACH.ENGINE.FRAME_START',
  'ARM.INV.COACH.ENGINE.FRAME_NEXT',
  'ARM.INV.COACH.ENGINE.PATH_CHOICE',
  'ARM.INV.COACH.ENGINE.MSV_EXPLAIN',
  'ARM.INV.COACH.ENGINE.TO_SIMULATION',
  'ARM.INV.COACH.ENGINE.OBJECTION_DEBT',
  'ARM.INV.COACH.ENGINE.OBJECTION_RISK',

  // --- Kaufy Persona (Z3) ---
  'ARM.Z3.KAUFY.TO_REGISTER',
  'ARM.Z3.KAUFY.PRESENT_LISTING',

  // --- FutureRoom Persona (Z3) ---
  'ARM.Z3.FR.EXPLAIN_PROCESS',
  'ARM.Z3.FR.START_SELBSTAUSKUNFT',
  'ARM.Z3.FR.DOCS_CHECKLIST',

  // --- SoT Persona (Z3) ---
  'ARM.Z3.SOT.HOW_IT_WORKS',
  'ARM.Z3.SOT.EXPLAIN_MODULE',
  'ARM.Z3.SOT.TO_REGISTER',
] as const;

export type Zone3ActionCode = typeof ZONE3_ALLOWED_ACTION_CODES[number];

// =============================================================================
// PERSONA PACKS — Convenience arrays for persona-specific filtering
// =============================================================================

const ZONE3_SHARED_CODES: Zone3ActionCode[] = [
  'ARM.GLOBAL.EXPLAIN_TERM', 'ARM.GLOBAL.FAQ',
  'ARM.PUBLIC.RENDITE_RECHNER', 'ARM.PUBLIC.TILGUNG_RECHNER', 'ARM.PUBLIC.BELASTUNG_RECHNER',
  'ARM.PUBLIC.CONTACT_REQUEST', 'ARM.PUBLIC.NEWSLETTER_SIGNUP',
  'ARM.PUBLIC.EXPLAIN_LISTING', 'ARM.PUBLIC.COMPARE_LISTINGS',
];

/** Kaufy: Immobilienverkauf & Investment-Beratung */
export const KAUFY_PACK: Zone3ActionCode[] = [
  ...ZONE3_SHARED_CODES,
  'ARM.Z3.KAUFY.TO_REGISTER',
  'ARM.Z3.KAUFY.PRESENT_LISTING',
  'ARM.INV.COACH.AUTO_START', 'ARM.INV.COACH.DISMISS', 'ARM.INV.COACH.RESUME',
  'ARM.INV.COACH.PAUSE_FOR_USER', 'ARM.INV.COACH.TO_SIMULATION',
];

/** FutureRoom: Finanzierungsberatung */
export const FUTUREROOM_PACK: Zone3ActionCode[] = [
  ...ZONE3_SHARED_CODES,
  'ARM.Z3.FR.EXPLAIN_PROCESS',
  'ARM.Z3.FR.START_SELBSTAUSKUNFT',
  'ARM.Z3.FR.DOCS_CHECKLIST',
];

/** SoT: Plattform-Erklärer & Registrierung */
export const SOT_PACK: Zone3ActionCode[] = [
  ...ZONE3_SHARED_CODES,
  'ARM.Z3.SOT.HOW_IT_WORKS',
  'ARM.Z3.SOT.EXPLAIN_MODULE',
  'ARM.Z3.SOT.TO_REGISTER',
  'ARM.INV.COACH.AUTO_START', 'ARM.INV.COACH.DISMISS', 'ARM.INV.COACH.RESUME',
  'ARM.INV.COACH.PAUSE_FOR_USER', 'ARM.INV.COACH.TO_SIMULATION',
];

/**
 * Get the persona pack for a given route
 */
export function getPersonaPack(route: string): Zone3ActionCode[] | null {
  if (route.startsWith('/website/kaufy') || route.startsWith('/kaufy')) return KAUFY_PACK;
  if (route.startsWith('/website/futureroom') || route.startsWith('/futureroom')) return FUTUREROOM_PACK;
  if (route.startsWith('/website/sot') || route.startsWith('/sot')) return SOT_PACK;
  return null;
}

// =============================================================================
// ACTIONS REGISTRY (V2 Schema)
// =============================================================================

export const armstrongActions: ArmstrongActionV2[] = [
  // ===========================================================================
  // GLOBAL ACTIONS (Available in Z2 and Z3)
  // ===========================================================================
  {
    action_code: 'ARM.GLOBAL.EXPLAIN_TERM',
    title_de: 'Begriff erklären',
    description_de: 'Erklärt Immobilien- und Finanzierungsbegriffe verständlich',
    zones: ['Z2', 'Z3'],
    module: null,
    risk_level: 'low',
    execution_mode: 'readonly',
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['knowledge_base'],
    data_scopes_write: [],
    side_effects: [],
    version: '1.0.0',
    cost_model: 'free',
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'tool_call', endpoint: null, tool_name: 'search_knowledge' },
    ui_entrypoints: ['/portal', '/kaufy', '/miety', '/sot', '/futureroom'],
    audit_event_type: 'ARM_EXPLAIN_TERM',
    status: 'active',
  },
  {
    action_code: 'ARM.GLOBAL.FAQ',
    title_de: 'FAQ beantworten',
    description_de: 'Beantwortet häufig gestellte Fragen zu Plattform und Prozessen',
    zones: ['Z2', 'Z3'],
    module: null,
    risk_level: 'low',
    execution_mode: 'readonly',
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['knowledge_base'],
    data_scopes_write: [],
    side_effects: [],
    version: '1.0.0',
    cost_model: 'free',
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'internal', endpoint: null },
    ui_entrypoints: ['/portal', '/kaufy', '/miety', '/sot', '/futureroom'],
    audit_event_type: 'ARM_FAQ',
    status: 'active',
  },
  {
    action_code: 'ARM.GLOBAL.HOW_IT_WORKS',
    title_de: 'Modul-Onboarding',
    description_de: 'Erklärt wie ein Modul funktioniert und führt durch erste Schritte',
    zones: ['Z2'],
    module: null,
    risk_level: 'low',
    execution_mode: 'readonly',
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['routes_manifest', 'knowledge_base'],
    data_scopes_write: [],
    side_effects: [],
    version: '1.0.0',
    cost_model: 'free',
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'internal', endpoint: null },
    ui_entrypoints: ['/portal'],
    audit_event_type: 'ARM_HOW_IT_WORKS',
    status: 'active',
  },
  {
    action_code: 'ARM.GLOBAL.WEB_SEARCH',
    title_de: 'Web-Recherche',
    description_de: 'Recherchiert im Web nach aktuellen Informationen (mit Quellennachweis)',
    zones: ['Z2'],
    module: null,
    risk_level: 'medium',
    execution_mode: 'execute_with_confirmation',
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: [],
    data_scopes_write: [],
    side_effects: ['external_api_call', 'credits_consumed'],
    version: '1.0.0',
    cost_model: 'metered',
    cost_unit: 'per_call',
    cost_hint_cents: 5,
    api_contract: { type: 'edge_function', endpoint: 'sot-armstrong-advisor' },
    ui_entrypoints: ['/portal'],
    audit_event_type: 'ARM_WEB_SEARCH',
    status: 'active',
  },

  // ===========================================================================
  // PUBLIC ACTIONS (Zone 3 - Lead Capture)
  // ===========================================================================
  {
    action_code: 'ARM.PUBLIC.RENDITE_RECHNER',
    title_de: 'Rendite berechnen',
    description_de: 'Berechnet Brutto-, Netto- und Eigenkapitalrendite',
    zones: ['Z2', 'Z3'],
    module: null,
    risk_level: 'low',
    execution_mode: 'readonly',
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: [],
    data_scopes_write: [],
    side_effects: [],
    version: '1.0.0',
    cost_model: 'free',
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'tool_call', endpoint: null, tool_name: 'calculate_investment' },
    ui_entrypoints: ['/kaufy', '/portal/investments'],
    audit_event_type: 'ARM_CALCULATE_YIELD',
    status: 'active',
  },
  {
    action_code: 'ARM.PUBLIC.TILGUNG_RECHNER',
    title_de: 'Tilgung berechnen',
    description_de: 'Berechnet Tilgungsplan und Restschuld',
    zones: ['Z2', 'Z3'],
    module: null,
    risk_level: 'low',
    execution_mode: 'readonly',
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: [],
    data_scopes_write: [],
    side_effects: [],
    version: '1.0.0',
    cost_model: 'free',
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'tool_call', endpoint: null, tool_name: 'calculate_investment' },
    ui_entrypoints: ['/kaufy', '/portal/finanzierung'],
    audit_event_type: 'ARM_CALCULATE_AMORTIZATION',
    status: 'active',
  },
  {
    action_code: 'ARM.PUBLIC.BELASTUNG_RECHNER',
    title_de: 'Monatliche Belastung berechnen',
    description_de: 'Berechnet die monatliche Netto-Belastung nach Steuern',
    zones: ['Z2', 'Z3'],
    module: null,
    risk_level: 'low',
    execution_mode: 'readonly',
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: [],
    data_scopes_write: [],
    side_effects: [],
    version: '1.0.0',
    cost_model: 'free',
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'tool_call', endpoint: null, tool_name: 'calculate_investment' },
    ui_entrypoints: ['/kaufy', '/portal/investments'],
    audit_event_type: 'ARM_CALCULATE_BURDEN',
    status: 'active',
  },
  {
    action_code: 'ARM.PUBLIC.CONTACT_REQUEST',
    title_de: 'Kontaktanfrage',
    description_de: 'Leitet eine Kontaktanfrage an das Lead-System weiter',
    zones: ['Z3'],
    module: null,
    risk_level: 'low',
    execution_mode: 'execute_with_confirmation',
    requires_consent_code: 'CONSENT_CONTACT',
    roles_allowed: [],
    data_scopes_read: [],
    data_scopes_write: [],
    side_effects: ['creates_lead_record', 'sends_notification'],
    version: '1.0.0',
    cost_model: 'free',
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'edge_function', endpoint: 'sot-lead-inbox' },
    ui_entrypoints: ['/kaufy', '/miety', '/sot', '/futureroom'],
    audit_event_type: 'ARM_CONTACT_REQUEST',
    status: 'active',
  },
  {
    action_code: 'ARM.PUBLIC.NEWSLETTER_SIGNUP',
    title_de: 'Newsletter anmelden',
    description_de: 'Meldet für den Newsletter an',
    zones: ['Z3'],
    module: null,
    risk_level: 'low',
    execution_mode: 'execute_with_confirmation',
    requires_consent_code: 'CONSENT_NEWSLETTER',
    roles_allowed: [],
    data_scopes_read: [],
    data_scopes_write: [],
    side_effects: ['creates_subscriber_record'],
    version: '1.0.0',
    cost_model: 'free',
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'edge_function', endpoint: 'sot-lead-inbox' },
    ui_entrypoints: ['/kaufy', '/miety', '/sot', '/futureroom'],
    audit_event_type: 'ARM_NEWSLETTER_SIGNUP',
    status: 'active',
  },
  {
    action_code: 'ARM.PUBLIC.EXPLAIN_LISTING',
    title_de: 'Objekt erklären',
    description_de: 'Erklärt Details eines öffentlichen Inserats',
    zones: ['Z2', 'Z3'],
    module: null,
    risk_level: 'low',
    execution_mode: 'readonly',
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['listings_published'],
    data_scopes_write: [],
    side_effects: [],
    version: '1.0.0',
    cost_model: 'free',
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'internal', endpoint: null },
    ui_entrypoints: ['/kaufy', '/portal/investments'],
    audit_event_type: 'ARM_EXPLAIN_LISTING',
    status: 'active',
  },
  {
    action_code: 'ARM.PUBLIC.COMPARE_LISTINGS',
    title_de: 'Objekte vergleichen',
    description_de: 'Vergleicht mehrere Inserate nach Kennzahlen',
    zones: ['Z2', 'Z3'],
    module: null,
    risk_level: 'low',
    execution_mode: 'readonly',
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['listings_published'],
    data_scopes_write: [],
    side_effects: [],
    version: '1.0.0',
    cost_model: 'free',
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'internal', endpoint: null },
    ui_entrypoints: ['/kaufy', '/portal/investments'],
    audit_event_type: 'ARM_COMPARE_LISTINGS',
    status: 'active',
  },

  // ===========================================================================
  // MOD-02: KI OFFICE ACTIONS
  // ===========================================================================
  {
    action_code: 'ARM.MOD02.SEND_LETTER',
    title_de: 'Brief absenden',
    description_de: 'Sendet einen vorbereiteten Brief per E-Mail, Fax oder Post',
    zones: ['Z2'],
    module: 'MOD-02',
    risk_level: 'medium',
    execution_mode: 'execute_with_confirmation',
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['letter_drafts', 'contacts'],
    data_scopes_write: ['letter_sent'],
    side_effects: ['modifies_letter_sent', 'sends_external_communication'],
    version: '1.0.0',
    cost_model: 'free',
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'edge_function', endpoint: 'sot-letter-send' },
    ui_entrypoints: ['/portal/office/brief'],
    audit_event_type: 'ARM_LETTER_SEND',
    status: 'active',
  },
  {
    action_code: 'ARM.MOD02.WA_SEND_REPLY',
    title_de: 'WhatsApp Antwort senden',
    description_de: 'Sendet eine Antwort über WhatsApp Business an einen Kontakt',
    zones: ['Z2'],
    module: 'MOD-02',
    risk_level: 'medium',
    execution_mode: 'execute_with_confirmation',
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['whatsapp_conversations', 'whatsapp_messages'],
    data_scopes_write: ['whatsapp_messages'],
    side_effects: ['sends_external_communication'],
    version: '1.0.0',
    cost_model: 'free',
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'edge_function', endpoint: 'sot-whatsapp-send' },
    ui_entrypoints: ['/portal/office/whatsapp'],
    audit_event_type: 'ARM_WA_SEND_REPLY',
    status: 'active',
  },
  {
    action_code: 'ARM.MOD02.WA_COMMAND_EXECUTE',
    title_de: 'Owner-Control Befehl ausführen',
    description_de: 'Verarbeitet einen WhatsApp-Befehl vom Owner und führt interne Aktionen sofort aus, externe als Widget zur Freigabe',
    zones: ['Z2'],
    module: 'MOD-02',
    risk_level: 'low',
    execution_mode: 'execute', // Runtime entscheidet: intern=sofort, extern=Widget zur Freigabe
    requires_consent_code: null,
    roles_allowed: ['org_admin'],
    data_scopes_read: ['whatsapp_messages', 'armstrong_command_events'],
    data_scopes_write: ['dashboard_widgets', 'letter_drafts', 'armstrong_command_events'],
    side_effects: ['creates_widget', 'creates_draft'],
    version: '1.0.0',
    cost_model: 'free',
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'edge_function', endpoint: 'sot-armstrong-advisor' },
    ui_entrypoints: ['/portal/office/whatsapp'],
    audit_event_type: 'ARM_WA_COMMAND_EXECUTE',
    status: 'active',
  },

  // ===========================================================================
  // MOD-14: COMMUNICATION PRO — RECHERCHE ACTIONS
  // ===========================================================================
  {
    action_code: 'ARM.MOD14.RESEARCH_FREE',
    title_de: 'Allgemeine Recherche',
    description_de: 'Führt eine kostenlose Web-Recherche durch und liefert eine strukturierte Zusammenfassung',
    zones: ['Z2'],
    module: 'MOD-14',
    risk_level: 'low',
    execution_mode: 'execute',
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: [],
    data_scopes_write: ['research_sessions', 'research_results'],
    side_effects: ['external_api_call'],
    version: '1.0.0',
    cost_model: 'free',
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'edge_function', endpoint: 'sot-research-engine' },
    ui_entrypoints: ['/portal/communication-pro/recherche'],
    audit_event_type: 'ARM_RESEARCH_FREE',
    status: 'active',
  },
  {
    action_code: 'ARM.MOD14.RESEARCH_PRO',
    title_de: 'Profi-Kontaktrecherche',
    description_de: 'Sucht professionelle Kontakte über Apollo und liefert Kandidatenliste',
    zones: ['Z2'],
    module: 'MOD-14',
    risk_level: 'low',
    execution_mode: 'execute_with_confirmation',
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: [],
    data_scopes_write: ['research_sessions', 'contact_candidates'],
    side_effects: ['external_api_call', 'credits_consumed'],
    version: '1.0.0',
    cost_model: 'metered',
    cost_unit: 'per_call',
    cost_hint_cents: null,
    api_contract: { type: 'edge_function', endpoint: 'sot-research-pro-contacts' },
    ui_entrypoints: ['/portal/communication-pro/recherche'],
    audit_event_type: 'ARM_RESEARCH_PRO',
    status: 'active',
  },
  {
    action_code: 'ARM.MOD14.IMPORT_CANDIDATES',
    title_de: 'Kontakte übernehmen',
    description_de: 'Übernimmt ausgewählte Kontakt-Kandidaten ins zentrale Kontaktbuch (1 Credit/Kontakt)',
    zones: ['Z2'],
    module: 'MOD-14',
    risk_level: 'low',
    execution_mode: 'execute_with_confirmation',
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['contact_candidates', 'contacts'],
    data_scopes_write: ['contacts', 'contact_candidates', 'credit_ledger'],
    side_effects: ['credits_consumed'],
    version: '1.0.0',
    cost_model: 'metered',
    cost_unit: 'per_call',
    cost_hint_cents: null,
    api_contract: { type: 'edge_function', endpoint: 'sot-contacts-import' },
    ui_entrypoints: ['/portal/communication-pro/recherche'],
    audit_event_type: 'ARM_IMPORT_CANDIDATES',
    status: 'active',
  },
  {
    action_code: 'ARM.MOD14.DEDUPE_SUGGEST',
    title_de: 'Duplikatprüfung',
    description_de: 'Prüft ob ein Kontakt-Kandidat bereits im Kontaktbuch existiert',
    zones: ['Z2'],
    module: 'MOD-14',
    risk_level: 'low',
    execution_mode: 'execute',
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['contact_candidates', 'contacts'],
    data_scopes_write: [],
    side_effects: [],
    version: '1.0.0',
    cost_model: 'free',
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'internal', endpoint: null },
    ui_entrypoints: ['/portal/communication-pro/recherche'],
    audit_event_type: 'ARM_DEDUPE_SUGGEST',
    status: 'active',
  },
  {
    action_code: 'ARM.MOD14.CREATE_RESEARCH_ORDER',
    title_de: 'Rechercheauftrag erstellen und ausführen',
    description_de: 'Erstellt einen neuen Rechercheauftrag, führt die Kontaktsuche durch und liefert qualifizierte Ergebnisse mit Kontaktbuch-Abgleich',
    zones: ['Z2'],
    module: 'MOD-14',
    risk_level: 'medium',
    execution_mode: 'execute_with_confirmation',
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['contacts'],
    data_scopes_write: ['research_orders', 'research_results', 'credit_ledger', 'widgets'],
    side_effects: ['credits_consumed', 'external_api_call', 'creates_widget'],
    version: '1.0.0',
    cost_model: 'metered',
    cost_unit: 'per_call',
    cost_hint_cents: 50,
    api_contract: { type: 'edge_function', endpoint: 'sot-research-run-order' },
    ui_entrypoints: ['/portal/communication-pro/recherche'],
    audit_event_type: 'ARM_CREATE_RESEARCH_ORDER',
    status: 'active',
  },

  // ===========================================================================
  // MOD-03: DMS ACTIONS
  // ===========================================================================
  {
    action_code: 'ARM.MOD03.SEARCH_DOC',
    title_de: 'Dokument suchen',
    description_de: 'Durchsucht das DMS nach Dokumenten',
    zones: ['Z2'],
    module: 'MOD-03',
    risk_level: 'low',
    execution_mode: 'readonly',
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['storage_nodes', 'documents'],
    data_scopes_write: [],
    side_effects: [],
    version: '1.0.0',
    cost_model: 'free',
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'rpc', endpoint: 'search_documents' },
    ui_entrypoints: ['/portal/dms'],
    audit_event_type: 'ARM_DOC_SEARCH',
    status: 'active',
  },
  {
    action_code: 'ARM.MOD03.EXPLAIN_UPLOAD',
    title_de: 'Upload-Workflow erklären',
    description_de: 'Erklärt wie Dokumente hochgeladen und organisiert werden',
    zones: ['Z2'],
    module: 'MOD-03',
    risk_level: 'low',
    execution_mode: 'readonly',
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['knowledge_base'],
    data_scopes_write: [],
    side_effects: [],
    version: '1.0.0',
    cost_model: 'free',
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'internal', endpoint: null },
    ui_entrypoints: ['/portal/dms'],
    audit_event_type: 'ARM_EXPLAIN_UPLOAD',
    status: 'active',
  },
  {
    action_code: 'ARM.MOD03.LINK_DOC',
    title_de: 'Dokument verknüpfen',
    description_de: 'Verknüpft ein Dokument mit einer Immobilie oder Entität',
    zones: ['Z2'],
    module: 'MOD-03',
    risk_level: 'medium',
    execution_mode: 'execute_with_confirmation',
    requires_consent_code: null,
    roles_allowed: ['org_admin', 'org_member'],
    data_scopes_read: ['storage_nodes', 'properties'],
    data_scopes_write: ['document_links'],
    side_effects: ['modifies_document_links'],
    version: '1.0.0',
    cost_model: 'free',
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'rpc', endpoint: 'link_document_to_entity' },
    ui_entrypoints: ['/portal/dms', '/portal/immobilien'],
    audit_event_type: 'ARM_DOC_LINK',
    status: 'active',
  },
  {
    action_code: 'ARM.MOD03.EXTRACT_DOC',
    title_de: 'Dokument extrahieren',
    description_de: 'Extrahiert strukturierte Daten aus einem Dokument via KI',
    zones: ['Z2'],
    module: 'MOD-03',
    risk_level: 'high',
    execution_mode: 'execute_with_confirmation',
    requires_consent_code: 'CONSENT_EXTRACTION',
    roles_allowed: ['org_admin'],
    data_scopes_read: ['storage_nodes', 'documents'],
    data_scopes_write: ['extracted_data'],
    side_effects: ['modifies_extracted_data', 'credits_consumed'],
    preconditions: ['document_exists', 'document_readable'],
    postconditions: ['extraction_logged', 'billing_event_created'],
    version: '1.0.0',
    cost_model: 'metered',
    cost_unit: 'per_page',
    cost_hint_cents: 2,
    api_contract: { type: 'edge_function', endpoint: 'sot-document-parser' },
    ui_entrypoints: ['/portal/dms'],
    audit_event_type: 'ARM_DOC_EXTRACT',
    status: 'active',
  },

  // ===========================================================================
  // MOD-04: IMMOBILIEN ACTIONS
  // ===========================================================================
  {
    action_code: 'ARM.MOD04.EXPLAIN_MODULE',
    title_de: 'Immobilien-Modul erklären',
    description_de: 'Erklärt die Funktionen des Immobilien-Moduls',
    zones: ['Z2'],
    module: 'MOD-04',
    risk_level: 'low',
    execution_mode: 'readonly',
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['knowledge_base'],
    data_scopes_write: [],
    side_effects: [],
    version: '1.0.0',
    cost_model: 'free',
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'internal', endpoint: null },
    ui_entrypoints: ['/portal/immobilien'],
    audit_event_type: 'ARM_EXPLAIN_MOD04',
    status: 'active',
  },
  {
    action_code: 'ARM.MOD04.VALIDATE_PROPERTY',
    title_de: 'Datenqualität prüfen',
    description_de: 'Analysiert Vollständigkeit und Qualität der Immobiliendaten',
    zones: ['Z2'],
    module: 'MOD-04',
    risk_level: 'low',
    execution_mode: 'readonly',
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['properties', 'units', 'leases'],
    data_scopes_write: [],
    side_effects: ['credits_consumed'],
    version: '1.0.0',
    cost_model: 'metered',
    cost_unit: 'per_call',
    cost_hint_cents: 1,
    api_contract: { type: 'internal', endpoint: null },
    ui_entrypoints: ['/portal/immobilien'],
    audit_event_type: 'ARM_VALIDATE_PROPERTY',
    status: 'active',
  },
  {
    action_code: 'ARM.MOD04.CREATE_PROPERTY',
    title_de: 'Immobilie anlegen',
    description_de: 'Erstellt einen neuen Immobilien-Datensatz',
    zones: ['Z2'],
    module: 'MOD-04',
    risk_level: 'high',
    execution_mode: 'execute_with_confirmation',
    requires_consent_code: null,
    roles_allowed: ['org_admin'],
    data_scopes_read: [],
    data_scopes_write: ['properties'],
    side_effects: ['modifies_properties'],
    preconditions: ['user_is_org_admin'],
    postconditions: ['property_created', 'audit_logged'],
    version: '1.0.0',
    cost_model: 'free',
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'edge_function', endpoint: 'sot-property-crud' },
    ui_entrypoints: ['/portal/immobilien/portfolio'],
    audit_event_type: 'ARM_PROPERTY_CREATE',
    status: 'active',
  },
  {
    action_code: 'ARM.MOD04.CREATE_UNIT',
    title_de: 'Einheit anlegen',
    description_de: 'Erstellt eine neue Einheit für eine Immobilie',
    zones: ['Z2'],
    module: 'MOD-04',
    risk_level: 'high',
    execution_mode: 'execute_with_confirmation',
    requires_consent_code: null,
    roles_allowed: ['org_admin'],
    data_scopes_read: ['properties'],
    data_scopes_write: ['units'],
    side_effects: ['modifies_units'],
    preconditions: ['property_exists', 'user_is_org_admin'],
    postconditions: ['unit_created', 'audit_logged'],
    version: '1.0.0',
    cost_model: 'free',
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'edge_function', endpoint: 'sot-property-crud' },
    ui_entrypoints: ['/portal/immobilien'],
    audit_event_type: 'ARM_UNIT_CREATE',
    status: 'active',
  },
  {
    action_code: 'ARM.MOD04.CALCULATE_KPI',
    title_de: 'KPIs berechnen',
    description_de: 'Berechnet Rendite, Cashflow und andere Kennzahlen',
    zones: ['Z2'],
    module: 'MOD-04',
    risk_level: 'low',
    execution_mode: 'readonly',
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['properties', 'units', 'leases'],
    data_scopes_write: [],
    side_effects: ['credits_consumed'],
    version: '1.0.0',
    cost_model: 'metered',
    cost_unit: 'per_call',
    cost_hint_cents: 1,
    api_contract: { type: 'tool_call', endpoint: null, tool_name: 'calculate_investment' },
    ui_entrypoints: ['/portal/immobilien'],
    audit_event_type: 'ARM_CALCULATE_KPI',
    status: 'active',
  },
  {
    action_code: 'ARM.MOD04.LINK_DOCUMENTS',
    title_de: 'Dokumente verknüpfen',
    description_de: 'Verknüpft Dokumente mit der Immobilienakte',
    zones: ['Z2'],
    module: 'MOD-04',
    risk_level: 'medium',
    execution_mode: 'execute_with_confirmation',
    requires_consent_code: null,
    roles_allowed: ['org_admin', 'org_member'],
    data_scopes_read: ['properties', 'storage_nodes'],
    data_scopes_write: ['document_links'],
    side_effects: ['modifies_document_links'],
    version: '1.0.0',
    cost_model: 'free',
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'rpc', endpoint: 'link_document_to_entity' },
    ui_entrypoints: ['/portal/immobilien'],
    audit_event_type: 'ARM_DOC_LINK',
    status: 'active',
  },
  {
    action_code: 'ARM.MOD04.DATA_QUALITY_CHECK',
    title_de: 'Vollständigkeit prüfen',
    description_de: 'Zeigt Checkliste der fehlenden Daten und Dokumente',
    zones: ['Z2'],
    module: 'MOD-04',
    risk_level: 'low',
    execution_mode: 'readonly',
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['properties', 'units', 'documents'],
    data_scopes_write: [],
    side_effects: [],
    version: '1.0.0',
    cost_model: 'free',
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'internal', endpoint: null },
    ui_entrypoints: ['/portal/immobilien'],
    audit_event_type: 'ARM_DATA_QUALITY',
    status: 'active',
  },

  // ===========================================================================
  // MOD-07: FINANZIERUNG ACTIONS
  // ===========================================================================
  {
    action_code: 'ARM.MOD07.EXPLAIN_SELBSTAUSKUNFT',
    title_de: 'Selbstauskunft erklären',
    description_de: 'Erklärt welche Daten benötigt werden und warum',
    zones: ['Z2'],
    module: 'MOD-07',
    risk_level: 'low',
    execution_mode: 'readonly',
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['knowledge_base'],
    data_scopes_write: [],
    side_effects: [],
    version: '1.0.0',
    cost_model: 'free',
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'internal', endpoint: null },
    ui_entrypoints: ['/portal/finanzierung'],
    audit_event_type: 'ARM_EXPLAIN_SELBSTAUSKUNFT',
    status: 'active',
  },
  {
    action_code: 'ARM.MOD07.DOC_CHECKLIST',
    title_de: 'Dokument-Checkliste',
    description_de: 'Zeigt welche Dokumente für die Finanzierung benötigt werden',
    zones: ['Z2'],
    module: 'MOD-07',
    risk_level: 'low',
    execution_mode: 'readonly',
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['applicant_profiles', 'documents'],
    data_scopes_write: [],
    side_effects: [],
    version: '1.0.0',
    cost_model: 'free',
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'internal', endpoint: null },
    ui_entrypoints: ['/portal/finanzierung'],
    audit_event_type: 'ARM_DOC_CHECKLIST',
    status: 'active',
  },
  {
    action_code: 'ARM.MOD07.PREPARE_EXPORT',
    title_de: 'Export vorbereiten',
    description_de: 'Bereitet das Finanzierungspaket für den Export vor',
    zones: ['Z2'],
    module: 'MOD-07',
    risk_level: 'medium',
    execution_mode: 'execute_with_confirmation',
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['applicant_profiles', 'documents', 'finance_requests'],
    data_scopes_write: ['export_packages'],
    side_effects: ['modifies_export_packages'],
    version: '1.0.0',
    cost_model: 'free',
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'edge_function', endpoint: 'sot-docs-export' },
    ui_entrypoints: ['/portal/finanzierung'],
    audit_event_type: 'ARM_PREPARE_EXPORT',
    status: 'active',
  },
  {
    action_code: 'ARM.MOD07.VALIDATE_READINESS',
    title_de: 'Finanzierungsbereitschaft',
    description_de: 'Analysiert ob alle Voraussetzungen für eine Finanzierungsanfrage erfüllt sind',
    zones: ['Z2'],
    module: 'MOD-07',
    risk_level: 'low',
    execution_mode: 'readonly',
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['applicant_profiles', 'documents'],
    data_scopes_write: [],
    side_effects: ['credits_consumed'],
    version: '1.0.0',
    cost_model: 'metered',
    cost_unit: 'per_call',
    cost_hint_cents: 2,
    api_contract: { type: 'internal', endpoint: null },
    ui_entrypoints: ['/portal/finanzierung'],
    audit_event_type: 'ARM_VALIDATE_READINESS',
    status: 'active',
  },

  // ===========================================================================
  // MOD-08: INVESTMENT-SUCHE ACTIONS
  // ===========================================================================
  {
    action_code: 'ARM.MOD08.ANALYZE_FAVORITE',
    title_de: 'Favorit analysieren',
    description_de: 'Analysiert ein Objekt aus den Favoriten mit Detailbewertung',
    zones: ['Z2'],
    module: 'MOD-08',
    risk_level: 'low',
    execution_mode: 'readonly',
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['favorites', 'listings'],
    data_scopes_write: [],
    side_effects: ['credits_consumed'],
    version: '1.0.0',
    cost_model: 'metered',
    cost_unit: 'per_call',
    cost_hint_cents: 3,
    api_contract: { type: 'tool_call', endpoint: null, tool_name: 'calculate_investment' },
    ui_entrypoints: ['/portal/investments'],
    audit_event_type: 'ARM_ANALYZE_FAVORITE',
    status: 'active',
  },
  {
    action_code: 'ARM.MOD08.RUN_SIMULATION',
    title_de: 'Investment-Simulation',
    description_de: 'Führt eine vollständige Investment-Simulation durch',
    zones: ['Z2'],
    module: 'MOD-08',
    risk_level: 'low',
    execution_mode: 'readonly',
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: [],
    data_scopes_write: [],
    side_effects: ['credits_consumed'],
    version: '1.0.0',
    cost_model: 'metered',
    cost_unit: 'per_call',
    cost_hint_cents: 2,
    api_contract: { type: 'edge_function', endpoint: 'sot-investment-engine' },
    ui_entrypoints: ['/portal/investments/simulation'],
    audit_event_type: 'ARM_RUN_SIMULATION',
    status: 'active',
  },
  {
    action_code: 'ARM.MOD08.CREATE_MANDATE',
    title_de: 'Suchmandat anlegen',
    description_de: 'Erstellt ein neues Suchmandat für die Akquise',
    zones: ['Z2'],
    module: 'MOD-08',
    risk_level: 'high',
    execution_mode: 'execute_with_confirmation',
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['applicant_profiles'],
    data_scopes_write: ['acq_mandates'],
    side_effects: ['modifies_acq_mandates'],
    preconditions: ['user_authenticated'],
    postconditions: ['mandate_created', 'audit_logged'],
    version: '1.0.0',
    cost_model: 'free',
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'rpc', endpoint: 'create_mandate' },
    ui_entrypoints: ['/portal/investments/mandat'],
    audit_event_type: 'ARM_CREATE_MANDATE',
    status: 'active',
  },
  {
    action_code: 'ARM.MOD08.WEB_RESEARCH',
    title_de: 'Standort-Recherche',
    description_de: 'Recherchiert Standortinformationen aus öffentlichen Quellen',
    zones: ['Z2'],
    module: 'MOD-08',
    risk_level: 'medium',
    execution_mode: 'execute_with_confirmation',
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: [],
    data_scopes_write: [],
    side_effects: ['external_api_call', 'credits_consumed'],
    version: '1.0.0',
    cost_model: 'metered',
    cost_unit: 'per_call',
    cost_hint_cents: 5,
    api_contract: { type: 'edge_function', endpoint: 'sot-armstrong-advisor' },
    ui_entrypoints: ['/portal/investments'],
    audit_event_type: 'ARM_WEB_RESEARCH',
    status: 'active',
  },

  // ===========================================================================
  // MOD-13: PROJEKTE (BAUTRÄGER) ACTIONS
  // ===========================================================================
  {
    action_code: 'ARM.MOD13.CREATE_DEV_PROJECT',
    title_de: 'Bauträgerprojekt anlegen',
    description_de: 'Erstellt ein neues Bauträgerprojekt aus hochgeladenen Dokumenten (Exposé, Preisliste) via KI-Analyse',
    zones: ['Z2'],
    module: 'MOD-13',
    risk_level: 'high',
    execution_mode: 'execute_with_confirmation',
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['tenant_documents'],
    data_scopes_write: ['dev_projects', 'dev_project_units', 'storage_nodes'],
    side_effects: ['modifies_dev_projects', 'creates_storage_tree', 'credits_consumed'],
    version: '1.0.0',
    cost_model: 'metered',
    cost_unit: 'per_call',
    cost_hint_cents: 500,
    api_contract: { type: 'edge_function', endpoint: 'sot-project-intake' },
    ui_entrypoints: ['/portal/projekte'],
    audit_event_type: 'ARM_CREATE_DEV_PROJECT',
    status: 'active',
  },
  {
    action_code: 'ARM.MOD13.EXPLAIN_MODULE',
    title_de: 'Projekte-Modul erklären',
    description_de: 'Erklärt Funktionsumfang und Golden Path des Projekte-Moduls (MOD-13)',
    zones: ['Z2'],
    module: 'MOD-13',
    risk_level: 'low',
    execution_mode: 'readonly',
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['knowledge_base'],
    data_scopes_write: [],
    side_effects: [],
    version: '1.0.0',
    cost_model: 'free',
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'internal', endpoint: null },
    ui_entrypoints: ['/portal/projekte'],
    audit_event_type: 'ARM_EXPLAIN_MOD13',
    status: 'active',
  },

  // ===========================================================================
  // MOD-00: DASHBOARD WIDGET ACTIONS
  // ===========================================================================
  {
    action_code: 'ARM.MOD00.CREATE_REMINDER',
    title_de: 'Erinnerung erstellen',
    description_de: 'Erstellt eine zeitbasierte Erinnerung als Widget',
    zones: ['Z2'],
    module: 'MOD-00',
    risk_level: 'low',
    execution_mode: 'execute', // K3-konform: low risk + free + interne Widget-Writes (keine externen Konsequenzen)
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: [],
    data_scopes_write: ['widgets'],
    side_effects: ['modifies_widgets'],
    version: '1.0.0',
    cost_model: 'free',
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'internal', endpoint: null },
    ui_entrypoints: ['/portal'],
    audit_event_type: 'ARM_CREATE_REMINDER',
    status: 'active',
  },
  {
    action_code: 'ARM.MOD00.CREATE_NOTE',
    title_de: 'Notiz erstellen',
    description_de: 'Erstellt eine schnelle Notiz als Widget',
    zones: ['Z2'],
    module: 'MOD-00',
    risk_level: 'low',
    execution_mode: 'execute', // K3-konform: low risk + free + interne Widget-Writes
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: [],
    data_scopes_write: ['widgets'],
    side_effects: ['modifies_widgets'],
    version: '1.0.0',
    cost_model: 'free',
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'internal', endpoint: null },
    ui_entrypoints: ['/portal'],
    audit_event_type: 'ARM_CREATE_NOTE',
    status: 'active',
  },
  {
    action_code: 'ARM.MOD00.CREATE_IDEA',
    title_de: 'Idee festhalten',
    description_de: 'Speichert eine kreative Idee als Widget',
    zones: ['Z2'],
    module: 'MOD-00',
    risk_level: 'low',
    execution_mode: 'execute', // K3-konform: low risk + free + interne Widget-Writes
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: [],
    data_scopes_write: ['widgets'],
    side_effects: ['modifies_widgets'],
    version: '1.0.0',
    cost_model: 'free',
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'internal', endpoint: null },
    ui_entrypoints: ['/portal'],
    audit_event_type: 'ARM_CREATE_IDEA',
    status: 'active',
  },
  {
    action_code: 'ARM.MOD00.CREATE_PROJECT',
    title_de: 'Projekt anlegen',
    description_de: 'Erstellt einen Projekt-Tracker als Widget',
    zones: ['Z2'],
    module: 'MOD-00',
    risk_level: 'low',
    execution_mode: 'execute', // K3-konform: low risk + free + interne Widget-Writes
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: [],
    data_scopes_write: ['widgets'],
    side_effects: ['modifies_widgets'],
    version: '1.0.0',
    cost_model: 'free',
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'internal', endpoint: null },
    ui_entrypoints: ['/portal'],
    audit_event_type: 'ARM_CREATE_PROJECT',
    status: 'active',
  },
  {
    action_code: 'ARM.MOD00.CREATE_TASK',
    title_de: 'Aufgabe erstellen',
    description_de: 'Erstellt eine To-Do-Aufgabe als Widget',
    zones: ['Z2'],
    module: 'MOD-00',
    risk_level: 'low',
    execution_mode: 'execute', // K3-konform: low risk + free + interne Widget-Writes
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: [],
    data_scopes_write: ['widgets'],
    side_effects: ['modifies_widgets'],
    version: '1.0.0',
    cost_model: 'free',
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'internal', endpoint: null },
    ui_entrypoints: ['/portal'],
    audit_event_type: 'ARM_CREATE_TASK',
    status: 'active',
  },
  {
    action_code: 'ARM.MOD00.CREATE_RESEARCH',
    title_de: 'Recherche erstellen',
    description_de: 'Erstellt eine Web-Recherche als Widget',
    zones: ['Z2'],
    module: 'MOD-00',
    risk_level: 'medium',
    execution_mode: 'execute_with_confirmation',
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: [],
    data_scopes_write: ['widgets'],
    side_effects: ['modifies_widgets', 'external_api_call', 'credits_consumed'],
    version: '1.0.0',
    cost_model: 'metered',
    cost_unit: 'per_call',
    cost_hint_cents: 5,
    api_contract: { type: 'edge_function', endpoint: 'sot-armstrong-advisor' },
    ui_entrypoints: ['/portal'],
    audit_event_type: 'ARM_CREATE_RESEARCH',
    status: 'active',
  },

  // ===========================================================================
  // KB: KNOWLEDGE BASE ACTIONS (Phase 6.4)
  // ===========================================================================
  {
    action_code: 'ARM.KB.CREATE_RESEARCH_MEMO',
    title_de: 'Research Memo erstellen',
    description_de: 'Erstellt ein Recherche-Memo für die Knowledge Base (nur Draft)',
    zones: ['Z2'],
    module: null,
    risk_level: 'medium',
    execution_mode: 'draft_only', // K4: Only creates draft, no SSOT writes
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: [],
    data_scopes_write: ['armstrong_knowledge_items'], // Draft only
    side_effects: ['creates_kb_draft', 'credits_consumed'],
    preconditions: ['user_authenticated'],
    postconditions: ['kb_draft_created', 'requires_review'],
    version: '1.0.0',
    cost_model: 'metered',
    cost_unit: 'per_call',
    cost_hint_cents: 300, // 6 Credits × 50 Cent
    credits_estimate: 6,
    api_contract: { type: 'edge_function', endpoint: 'sot-armstrong-advisor' },
    ui_entrypoints: ['/portal'],
    audit_event_type: 'ARM_KB_RESEARCH_MEMO',
    status: 'active',
  },
  {
    action_code: 'ARM.KB.SUGGEST_KB_ITEM_FROM_CHAT',
    title_de: 'KB-Artikel vorschlagen',
    description_de: 'Schlägt einen neuen Knowledge Base Artikel basierend auf Chat-Kontext vor (nur Draft)',
    zones: ['Z2'],
    module: null,
    risk_level: 'low',
    execution_mode: 'draft_only',
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['knowledge_base'],
    data_scopes_write: ['armstrong_knowledge_items'],
    side_effects: ['creates_kb_draft', 'credits_consumed'],
    preconditions: ['user_authenticated', 'chat_context_available'],
    postconditions: ['kb_draft_created', 'requires_review'],
    version: '1.0.0',
    cost_model: 'metered',
    cost_unit: 'per_call',
    cost_hint_cents: 100, // 2 Credits × 50 Cent
    credits_estimate: 2,
    api_contract: { type: 'edge_function', endpoint: 'sot-armstrong-advisor' },
    ui_entrypoints: ['/portal'],
    audit_event_type: 'ARM_KB_SUGGEST_ITEM',
    status: 'active',
  },
  {
    action_code: 'ARM.KB.BUILD_SALES_SCRIPT_VARIANTS',
    title_de: 'Verkaufsskript-Varianten erstellen',
    description_de: 'Generiert verschiedene Varianten eines Verkaufsskripts (nur Draft)',
    zones: ['Z2'],
    module: null,
    risk_level: 'low',
    execution_mode: 'draft_only',
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['knowledge_base'],
    data_scopes_write: ['armstrong_knowledge_items'],
    side_effects: ['creates_kb_draft', 'credits_consumed'],
    preconditions: ['user_authenticated', 'base_script_provided'],
    postconditions: ['kb_draft_created', 'requires_review'],
    version: '1.0.0',
    cost_model: 'metered',
    cost_unit: 'per_call',
    cost_hint_cents: 150, // 3 Credits × 50 Cent
    credits_estimate: 3,
    api_contract: { type: 'edge_function', endpoint: 'sot-armstrong-advisor' },
    ui_entrypoints: ['/portal', '/admin/armstrong/knowledge'],
    audit_event_type: 'ARM_KB_SALES_SCRIPT',
    status: 'active',
  },

  // ===========================================================================
  // PACK A: NEW GLOBAL ACTIONS (Phase 6 Content Blueprints)
  // ===========================================================================
  {
    action_code: 'ARM.GLOBAL.SUMMARIZE_TEXT',
    title_de: 'Text zusammenfassen',
    description_de: 'Fasst einen Text strukturiert zusammen (mit Disclaimer bei tax/legal)',
    zones: ['Z2'],
    module: null,
    risk_level: 'low',
    execution_mode: 'readonly',
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: [],
    data_scopes_write: [],
    side_effects: ['credits_consumed'],
    version: '1.0.0',
    cost_model: 'metered',
    cost_unit: 'per_call',
    cost_hint_cents: 100, // 2 Credits × 50 Cent
    credits_estimate: 2,
    api_contract: { type: 'edge_function', endpoint: 'sot-armstrong-advisor' },
    ui_entrypoints: ['/portal'],
    audit_event_type: 'ARM_SUMMARIZE_TEXT',
    status: 'active',
  },
  {
    action_code: 'ARM.GLOBAL.DRAFT_MESSAGE',
    title_de: 'Nachricht entwerfen',
    description_de: 'Erstellt einen Entwurf für eine E-Mail oder Nachricht (ohne Senden)',
    zones: ['Z2'],
    module: null,
    risk_level: 'medium',
    execution_mode: 'draft_only',
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['contacts'],
    data_scopes_write: [],
    side_effects: ['creates_draft', 'credits_consumed'],
    preconditions: ['user_authenticated'],
    postconditions: ['draft_available_for_review'],
    version: '1.0.0',
    cost_model: 'metered',
    cost_unit: 'per_call',
    cost_hint_cents: 100, // 2 Credits × 50 Cent
    credits_estimate: 2,
    api_contract: { type: 'edge_function', endpoint: 'sot-armstrong-advisor' },
    ui_entrypoints: ['/portal', '/portal/office'],
    audit_event_type: 'ARM_DRAFT_MESSAGE',
    status: 'active',
  },

  // ===========================================================================
  // PACK B: NEW WIDGET ACTION (Phase 6 Content Blueprints)
  // ===========================================================================
  {
    action_code: 'ARM.MOD00.ARCHIVE_WIDGET',
    title_de: 'Widget archivieren',
    description_de: 'Archiviert ein bestehendes Dashboard-Widget',
    zones: ['Z2'],
    module: 'MOD-00',
    risk_level: 'low',
    execution_mode: 'execute_with_confirmation',
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['widgets'],
    data_scopes_write: ['widgets'],
    side_effects: ['modifies_widgets'],
    version: '1.0.0',
    cost_model: 'free',
    cost_unit: null,
    cost_hint_cents: 0,
    credits_estimate: 0,
    api_contract: { type: 'internal', endpoint: null },
    ui_entrypoints: ['/portal'],
    audit_event_type: 'ARM_ARCHIVE_WIDGET',
    status: 'active',
  },

  // ===========================================================================
  // PACK C: NEW DMS ACTION (Phase 6 Content Blueprints)
  // ===========================================================================
  {
    action_code: 'ARM.MOD03.DOC_CONFIDENCE_REVIEW_ASSIST',
    title_de: 'Extraktions-Review unterstützen',
    description_de: 'Erklärt Needs-Review-Status und listet Confidence/Fields auf',
    zones: ['Z2'],
    module: 'MOD-03',
    risk_level: 'low',
    execution_mode: 'readonly',
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['storage_nodes', 'extracted_data'],
    data_scopes_write: [],
    side_effects: ['credits_consumed'],
    version: '1.0.0',
    cost_model: 'metered',
    cost_unit: 'per_call',
    cost_hint_cents: 100, // 2 Credits × 50 Cent
    credits_estimate: 2,
    api_contract: { type: 'internal', endpoint: null },
    ui_entrypoints: ['/portal/dms'],
    audit_event_type: 'ARM_DOC_CONFIDENCE_REVIEW',
    status: 'active',
  },

  // ===========================================================================
  // PACK D: NEW PROPERTY ACTIONS (Phase 6 Content Blueprints)
  // ===========================================================================
  {
    action_code: 'ARM.MOD04.SUGGEST_DOCUMENTS_CHECKLIST',
    title_de: 'Dokumenten-Checkliste vorschlagen',
    description_de: 'Schlägt vor, welche Dokumente für Bewertung/Finanzierung/Verkauf fehlen',
    zones: ['Z2'],
    module: 'MOD-04',
    risk_level: 'low',
    execution_mode: 'readonly',
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['properties', 'documents', 'knowledge_base'],
    data_scopes_write: [],
    side_effects: ['credits_consumed'],
    version: '1.0.0',
    cost_model: 'metered',
    cost_unit: 'per_call',
    cost_hint_cents: 100, // 2 Credits × 50 Cent
    credits_estimate: 2,
    api_contract: { type: 'internal', endpoint: null },
    ui_entrypoints: ['/portal/immobilien'],
    audit_event_type: 'ARM_SUGGEST_DOC_CHECKLIST',
    status: 'active',
  },
  {
    action_code: 'ARM.MOD04.GENERATE_EXPOSE_DRAFT',
    title_de: 'Exposé-Entwurf erstellen',
    description_de: 'Generiert einen Exposé-Textentwurf für internes Review (ohne Publizieren)',
    zones: ['Z2'],
    module: 'MOD-04',
    risk_level: 'medium',
    execution_mode: 'draft_only',
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['properties', 'units', 'documents'],
    data_scopes_write: [],
    side_effects: ['creates_draft', 'credits_consumed'],
    preconditions: ['property_exists', 'user_authenticated'],
    postconditions: ['draft_available_for_review'],
    version: '1.0.0',
    cost_model: 'metered',
    cost_unit: 'per_call',
    cost_hint_cents: 150, // 3 Credits × 50 Cent
    credits_estimate: 3,
    api_contract: { type: 'edge_function', endpoint: 'sot-armstrong-advisor' },
    ui_entrypoints: ['/portal/immobilien'],
    audit_event_type: 'ARM_GENERATE_EXPOSE_DRAFT',
    status: 'active',
  },

  // ===========================================================================
  // MOD-05: WEBSITE BUILDER ACTIONS (ehemals MOD-21)
  // ===========================================================================
  {
    action_code: 'ARM.LP.GENERATE_LANDING_PAGE',
    title_de: 'Landing Page generieren',
    description_de: 'Generiert eine Landing Page basierend auf Modul-Kontext und Design-Template per KI',
    zones: ['Z2'],
    module: null,
    risk_level: 'low',
    execution_mode: 'execute_with_confirmation',
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['landing_pages', 'website_profiles'],
    data_scopes_write: ['landing_pages'],
    side_effects: ['external_api_call', 'credits_consumed'],
    version: '1.0.0',
    cost_model: 'metered',
    cost_unit: 'per_call',
    cost_hint_cents: 250,
    credits_estimate: 5,
    api_contract: { type: 'edge_function', endpoint: 'sot-website-ai-generate' },
    ui_entrypoints: ['/portal/vertriebspartner/landing-page', '/portal/finanzierungsmanager/landing-page', '/portal/akquise-manager/landing-page', '/portal/projekte/landing-page'],
    audit_event_type: 'ARM_LP_GENERATE',
    status: 'active',
  },
  {
    action_code: 'ARM.LP.PUBLISH',
    title_de: 'Landing Page veröffentlichen',
    description_de: 'Macht die Landing Page öffentlich erreichbar',
    zones: ['Z2'],
    module: null,
    risk_level: 'medium',
    execution_mode: 'execute_with_confirmation',
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['landing_pages'],
    data_scopes_write: ['landing_pages'],
    side_effects: ['credits_consumed', 'public_exposure'],
    version: '1.0.0',
    cost_model: 'metered',
    cost_unit: 'per_call',
    cost_hint_cents: 500,
    credits_estimate: 10,
    api_contract: { type: 'edge_function', endpoint: 'sot-website-publish' },
    ui_entrypoints: ['/portal/vertriebspartner/landing-page', '/portal/finanzierungsmanager/landing-page', '/portal/akquise-manager/landing-page', '/portal/projekte/landing-page'],
    audit_event_type: 'ARM_LP_PUBLISH',
    status: 'active',
  },

  // ===========================================================================
  // MOD-19: PHOTOVOLTAIK — PV-Anlagen-Anbindung & Monitoring
  // ===========================================================================
  {
    action_code: 'ARM.MOD19.EXPLAIN_PV_CONNECT',
    title_de: 'PV-Anlage verbinden — Anleitung',
    description_de: 'Erklärt Schritt für Schritt, wie eine Photovoltaik-Anlage (SMA, Solar-Log u.a.) mit dem System verbunden wird. Deckt WLAN-Anbindung, Wechselrichter-Zugang, Passwörter und zukünftige API-Integration ab.',
    zones: ['Z2'],
    module: 'MOD-19',
    risk_level: 'low',
    execution_mode: 'readonly',
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['knowledge_base', 'pv_plants'],
    data_scopes_write: [],
    side_effects: [],
    version: '1.0.0',
    cost_model: 'free',
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'tool_call', endpoint: null, tool_name: 'search_knowledge' },
    ui_entrypoints: ['/portal/photovoltaik', '/portal/photovoltaik/anlagen'],
    audit_event_type: 'ARM_PV_EXPLAIN_CONNECT',
    status: 'active',
  },
  {
    action_code: 'ARM.MOD19.EXPLAIN_PV_MONITORING',
    title_de: 'PV-Monitoring erklärt',
    description_de: 'Erklärt, wie das Live-Monitoring funktioniert, was Soll- vs. Ist-Ertrag bedeutet und wie die PVGIS-Soll-Kurve zu interpretieren ist.',
    zones: ['Z2'],
    module: 'MOD-19',
    risk_level: 'low',
    execution_mode: 'readonly',
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['knowledge_base', 'pv_plants', 'pv_measurements'],
    data_scopes_write: [],
    side_effects: [],
    version: '1.0.0',
    cost_model: 'free',
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'tool_call', endpoint: null, tool_name: 'search_knowledge' },
    ui_entrypoints: ['/portal/photovoltaik'],
    audit_event_type: 'ARM_PV_EXPLAIN_MONITORING',
    status: 'active',
  },

  // ===========================================================================
  // MOD-00: MEETING RECORDER
  // ===========================================================================
  {
    action_code: 'ARM.MOD00.START_MEETING_RECORDER',
    title_de: 'Meeting-Aufnahme starten',
    description_de: 'Startet die Live-Transkription einer physischen Besprechung. Kein Audio wird gespeichert — nur Text.',
    module: 'MOD-00',
    zones: ['Z2'] as ArmstrongZone[],
    execution_mode: 'execute' as ExecutionMode,
    risk_level: 'low' as RiskLevel,
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: [],
    data_scopes_write: ['meeting_sessions', 'meeting_transcript_chunks', 'task_widgets'],
    side_effects: ['meeting_recording_started'],
    version: '1.0.0',
    cost_model: 'metered' as CostModel,
    cost_unit: 'per_meeting' as CostUnit,
    cost_hint_cents: 50,
    api_contract: { type: 'internal', endpoint: null, tool_name: 'start_meeting_recorder' },
    ui_entrypoints: ['/portal/dashboard'],
    audit_event_type: 'ARM_MEETING_RECORDER_START',
    status: 'active' as ActionStatus,
  },

  // ===========================================================================
  // DOSSIER AUTO-RESEARCH (Cross-Module)
  // ===========================================================================
  {
    action_code: 'ARM.DOSSIER.AUTO_RESEARCH_VEHICLE',
    title_de: 'Fahrzeug-Dossier recherchieren',
    description_de: 'Recherchiert automatisch alle relevanten Informationen zu einem neu angelegten Fahrzeug (Technische Daten, Wartung, Rückrufe).',
    module: 'MOD-17',
    zones: ['Z2'] as ArmstrongZone[],
    execution_mode: 'execute' as ExecutionMode,
    risk_level: 'low' as RiskLevel,
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['cars_vehicles'],
    data_scopes_write: ['dossier_research_jobs', 'task_widgets'],
    side_effects: ['creates_research_job', 'creates_task_widget', 'stores_knowledge_json'],
    version: '1.0.0',
    cost_model: 'metered' as CostModel,
    cost_unit: 'per_call' as CostUnit,
    cost_hint_cents: 25,
    credits_estimate: 1,
    api_contract: { type: 'edge_function', endpoint: 'sot-dossier-auto-research' },
    ui_entrypoints: ['/portal/cars'],
    audit_event_type: 'ARM_DOSSIER_VEHICLE_RESEARCH',
    status: 'active' as ActionStatus,
  },
  {
    action_code: 'ARM.DOSSIER.AUTO_RESEARCH_INSURANCE',
    title_de: 'Versicherungsbedingungen recherchieren',
    description_de: 'Recherchiert automatisch Versicherungsbedingungen, Deckungsumfang und wichtige Klauseln einer neu angelegten Versicherung.',
    module: 'MOD-18',
    zones: ['Z2'] as ArmstrongZone[],
    execution_mode: 'execute' as ExecutionMode,
    risk_level: 'low' as RiskLevel,
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['insurance_contracts'],
    data_scopes_write: ['dossier_research_jobs', 'task_widgets'],
    side_effects: ['creates_research_job', 'creates_task_widget', 'stores_knowledge_json'],
    version: '1.0.0',
    cost_model: 'metered' as CostModel,
    cost_unit: 'per_call' as CostUnit,
    cost_hint_cents: 25,
    credits_estimate: 1,
    api_contract: { type: 'edge_function', endpoint: 'sot-dossier-auto-research' },
    ui_entrypoints: ['/portal/finanzen/sachversicherungen'],
    audit_event_type: 'ARM_DOSSIER_INSURANCE_RESEARCH',
    status: 'active' as ActionStatus,
  },
  {
    action_code: 'ARM.DOSSIER.AUTO_RESEARCH_PV',
    title_de: 'PV-Anlage-Dossier recherchieren',
    description_de: 'Recherchiert automatisch technische Daten, Wartungshinweise und Garantiebedingungen einer neu angelegten PV-Anlage.',
    module: 'MOD-19',
    zones: ['Z2'] as ArmstrongZone[],
    execution_mode: 'execute' as ExecutionMode,
    risk_level: 'low' as RiskLevel,
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['pv_plants'],
    data_scopes_write: ['dossier_research_jobs', 'task_widgets'],
    side_effects: ['creates_research_job', 'creates_task_widget', 'stores_knowledge_json'],
    version: '1.0.0',
    cost_model: 'metered' as CostModel,
    cost_unit: 'per_call' as CostUnit,
    cost_hint_cents: 25,
    credits_estimate: 1,
    api_contract: { type: 'edge_function', endpoint: 'sot-dossier-auto-research' },
    ui_entrypoints: ['/portal/photovoltaik'],
    audit_event_type: 'ARM_DOSSIER_PV_RESEARCH',
    status: 'active' as ActionStatus,
  },
  {
    action_code: 'ARM.DOSSIER.VIEW_RESEARCH',
    title_de: 'Recherche-Ergebnis anzeigen',
    description_de: 'Zeigt das Ergebnis einer abgeschlossenen Dossier-Recherche an.',
    module: null,
    zones: ['Z2'] as ArmstrongZone[],
    execution_mode: 'readonly' as ExecutionMode,
    risk_level: 'low' as RiskLevel,
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['dossier_research_jobs'],
    data_scopes_write: [],
    side_effects: [],
    version: '1.0.0',
    cost_model: 'free' as CostModel,
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'internal', endpoint: null, tool_name: 'view_dossier_research' },
    ui_entrypoints: ['/portal'],
    audit_event_type: 'ARM_DOSSIER_VIEW_RESEARCH',
    status: 'active' as ActionStatus,
  },

  // ===========================================================================
  // INVESTMENT COACH — LIFECYCLE ACTIONS (5)
  // ===========================================================================
  ...([
    ['ARM.INV.COACH.AUTO_START', 'Coach Auto-Start', 'Startet den Investment Coach bei Engine/Slideshow'],
    ['ARM.INV.COACH.DISMISS', 'Coach ausblenden', 'Blendet den Coach für 24h aus'],
    ['ARM.INV.COACH.RESUME', 'Coach fortsetzen', 'Reaktiviert den Coach nach Dismiss'],
    ['ARM.INV.COACH.PAUSE_FOR_USER', 'Coach pausieren', 'Pausiert die Narration bei User-Frage'],
    ['ARM.INV.COACH.TO_SIMULATION', 'Zur Simulation', 'Leitet zur Investment-Simulation'],
  ] as const).map(([code, title, desc]) => ({
    action_code: code,
    title_de: title,
    description_de: desc,
    zones: ['Z2', 'Z3'] as ArmstrongZone[],
    module: 'MOD-08',
    risk_level: 'low' as RiskLevel,
    execution_mode: 'readonly' as ExecutionMode,
    requires_consent_code: null,
    roles_allowed: [] as string[],
    data_scopes_read: ['knowledge_base'],
    data_scopes_write: [] as string[],
    side_effects: [] as string[],
    version: '1.0.0',
    cost_model: 'free' as CostModel,
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'internal' as const, endpoint: null },
    ui_entrypoints: ['/portal/investments', '/portal/vertriebspartner', '/kaufy', '/sot'],
    audit_event_type: `ARM_COACH_LIFECYCLE`,
    status: 'active' as ActionStatus,
  })),

  // ===========================================================================
  // INVESTMENT COACH — SLIDE COACHING ACTIONS (28)
  // ===========================================================================
  ...([
    ...Array.from({ length: 8 }, (_, i) => [`ARM.INV.COACH.VERKAUF.S${i+1}`, `Verkauf Slide ${i+1}`, `Coaching Verkaufspräsentation Slide ${i+1}`] as const),
    ...Array.from({ length: 7 }, (_, i) => [`ARM.INV.COACH.RENDITE.S${i+1}`, `Rendite Slide ${i+1}`, `Coaching Rendite Slide ${i+1}`] as const),
    ...Array.from({ length: 6 }, (_, i) => [`ARM.INV.COACH.STEUER.S${i+1}`, `Steuer Slide ${i+1}`, `Coaching Steuervorteil Slide ${i+1}`] as const),
    ...Array.from({ length: 7 }, (_, i) => [`ARM.INV.COACH.SOFT.S${i+1}`, `Software Slide ${i+1}`, `Coaching Verwaltung Slide ${i+1}`] as const),
  ]).map(([code, title, desc]) => ({
    action_code: code,
    title_de: title,
    description_de: desc,
    zones: ['Z2', 'Z3'] as ArmstrongZone[],
    module: 'MOD-08',
    risk_level: 'low' as RiskLevel,
    execution_mode: 'readonly' as ExecutionMode,
    requires_consent_code: null,
    roles_allowed: [] as string[],
    data_scopes_read: ['knowledge_base'],
    data_scopes_write: [] as string[],
    side_effects: [] as string[],
    version: '1.0.0',
    cost_model: 'free' as CostModel,
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'internal' as const, endpoint: null },
    ui_entrypoints: ['/portal/investments', '/portal/vertriebspartner', '/kaufy', '/sot'],
    audit_event_type: 'ARM_COACH_SLIDE',
    status: 'active' as ActionStatus,
  })),

  // ===========================================================================
  // INVESTMENT COACH — ENGINE ON-PAGE ACTIONS (8)
  // ===========================================================================
  ...([
    ['ARM.INV.COACH.ENGINE.INTRO', 'Engine Einführung', 'Führungsangebot für die Investment Engine'],
    ['ARM.INV.COACH.ENGINE.FRAME_START', 'Rahmen starten', 'EK und Puffer erfragen'],
    ['ARM.INV.COACH.ENGINE.FRAME_NEXT', 'Rahmen weiter', 'Netto und Ziel erfragen'],
    ['ARM.INV.COACH.ENGINE.PATH_CHOICE', 'Weg wählen', 'Marktplatz vs Mandat erklären'],
    ['ARM.INV.COACH.ENGINE.MSV_EXPLAIN', 'MSV erklären', 'Mietsonderverwaltung kurz erklären'],
    ['ARM.INV.COACH.ENGINE.TO_SIMULATION', 'Simulation starten', 'Zur Simulation leiten'],
    ['ARM.INV.COACH.ENGINE.OBJECTION_DEBT', 'Einwand Schulden', 'Einwandbehandlung Schulden-Bedenken'],
    ['ARM.INV.COACH.ENGINE.OBJECTION_RISK', 'Einwand Risiko', 'Einwandbehandlung Risiko-Bedenken'],
  ] as const).map(([code, title, desc]) => ({
    action_code: code,
    title_de: title,
    description_de: desc,
    zones: ['Z2', 'Z3'] as ArmstrongZone[],
    module: 'MOD-08',
    risk_level: 'low' as RiskLevel,
    execution_mode: 'readonly' as ExecutionMode,
    requires_consent_code: null,
    roles_allowed: [] as string[],
    data_scopes_read: ['knowledge_base'],
    data_scopes_write: [] as string[],
    side_effects: [] as string[],
    version: '1.0.0',
    cost_model: 'free' as CostModel,
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'internal' as const, endpoint: null },
    ui_entrypoints: ['/portal/investments', '/portal/vertriebspartner', '/kaufy', '/sot'],
    audit_event_type: 'ARM_COACH_ENGINE',
    status: 'active' as ActionStatus,
  })),

  // ===========================================================================
  // ZONE 3 PERSONA-SPECIFIC ACTIONS (8)
  // ===========================================================================

  // --- Kaufy Persona ---
  {
    action_code: 'ARM.Z3.KAUFY.TO_REGISTER',
    title_de: 'Zur Registrierung leiten',
    description_de: 'Leitet den Nutzer zum Portal-Registrierungs-Funnel',
    zones: ['Z3'] as ArmstrongZone[],
    module: null,
    risk_level: 'low' as RiskLevel,
    execution_mode: 'execute' as ExecutionMode,
    requires_consent_code: null,
    roles_allowed: [] as string[],
    data_scopes_read: [] as string[],
    data_scopes_write: [] as string[],
    side_effects: ['navigation'],
    version: '1.0.0',
    cost_model: 'free' as CostModel,
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'internal' as const, endpoint: null },
    ui_entrypoints: ['/website/kaufy', '/kaufy'],
    audit_event_type: 'ARM_Z3_KAUFY_REGISTER',
    status: 'active' as ActionStatus,
  },
  {
    action_code: 'ARM.Z3.KAUFY.PRESENT_LISTING',
    title_de: 'Objekt vorstellen',
    description_de: 'Stellt ein Kaufy-Inserat mit Storytelling vor',
    zones: ['Z3'] as ArmstrongZone[],
    module: null,
    risk_level: 'low' as RiskLevel,
    execution_mode: 'readonly' as ExecutionMode,
    requires_consent_code: null,
    roles_allowed: [] as string[],
    data_scopes_read: ['v_public_listings'],
    data_scopes_write: [] as string[],
    side_effects: [] as string[],
    version: '1.0.0',
    cost_model: 'free' as CostModel,
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'internal' as const, endpoint: null },
    ui_entrypoints: ['/website/kaufy', '/kaufy'],
    audit_event_type: 'ARM_Z3_KAUFY_PRESENT',
    status: 'active' as ActionStatus,
  },

  // --- FutureRoom Persona ---
  {
    action_code: 'ARM.Z3.FR.EXPLAIN_PROCESS',
    title_de: 'Finanzierungsprozess erklären',
    description_de: 'Erklärt den FutureRoom-Finanzierungsprozess Schritt für Schritt',
    zones: ['Z3'] as ArmstrongZone[],
    module: null,
    risk_level: 'low' as RiskLevel,
    execution_mode: 'readonly' as ExecutionMode,
    requires_consent_code: null,
    roles_allowed: [] as string[],
    data_scopes_read: ['knowledge_base'],
    data_scopes_write: [] as string[],
    side_effects: [] as string[],
    version: '1.0.0',
    cost_model: 'free' as CostModel,
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'internal' as const, endpoint: null },
    ui_entrypoints: ['/website/futureroom', '/futureroom'],
    audit_event_type: 'ARM_Z3_FR_EXPLAIN',
    status: 'active' as ActionStatus,
  },
  {
    action_code: 'ARM.Z3.FR.START_SELBSTAUSKUNFT',
    title_de: 'Selbstauskunft starten',
    description_de: 'Leitet den Nutzer zur digitalen Selbstauskunft',
    zones: ['Z3'] as ArmstrongZone[],
    module: null,
    risk_level: 'low' as RiskLevel,
    execution_mode: 'execute' as ExecutionMode,
    requires_consent_code: null,
    roles_allowed: [] as string[],
    data_scopes_read: [] as string[],
    data_scopes_write: [] as string[],
    side_effects: ['navigation'],
    version: '1.0.0',
    cost_model: 'free' as CostModel,
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'internal' as const, endpoint: null },
    ui_entrypoints: ['/website/futureroom', '/futureroom'],
    audit_event_type: 'ARM_Z3_FR_SELBSTAUSKUNFT',
    status: 'active' as ActionStatus,
  },
  {
    action_code: 'ARM.Z3.FR.DOCS_CHECKLIST',
    title_de: 'Unterlagen-Checkliste',
    description_de: 'Zeigt die benötigten Unterlagen für eine Finanzierungsanfrage',
    zones: ['Z3'] as ArmstrongZone[],
    module: null,
    risk_level: 'low' as RiskLevel,
    execution_mode: 'readonly' as ExecutionMode,
    requires_consent_code: null,
    roles_allowed: [] as string[],
    data_scopes_read: ['knowledge_base'],
    data_scopes_write: [] as string[],
    side_effects: [] as string[],
    version: '1.0.0',
    cost_model: 'free' as CostModel,
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'internal' as const, endpoint: null },
    ui_entrypoints: ['/website/futureroom', '/futureroom'],
    audit_event_type: 'ARM_Z3_FR_DOCS',
    status: 'active' as ActionStatus,
  },

  // --- SoT Persona ---
  {
    action_code: 'ARM.Z3.SOT.HOW_IT_WORKS',
    title_de: 'Plattform erklären',
    description_de: 'Erklärt wie System of a Town funktioniert',
    zones: ['Z3'] as ArmstrongZone[],
    module: null,
    risk_level: 'low' as RiskLevel,
    execution_mode: 'readonly' as ExecutionMode,
    requires_consent_code: null,
    roles_allowed: [] as string[],
    data_scopes_read: ['knowledge_base'],
    data_scopes_write: [] as string[],
    side_effects: [] as string[],
    version: '1.0.0',
    cost_model: 'free' as CostModel,
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'internal' as const, endpoint: null },
    ui_entrypoints: ['/website/sot', '/sot'],
    audit_event_type: 'ARM_Z3_SOT_HOW',
    status: 'active' as ActionStatus,
  },
  {
    action_code: 'ARM.Z3.SOT.EXPLAIN_MODULE',
    title_de: 'Modul vorstellen',
    description_de: 'Erklärt ein bestimmtes Portal-Modul für potenzielle Nutzer',
    zones: ['Z3'] as ArmstrongZone[],
    module: null,
    risk_level: 'low' as RiskLevel,
    execution_mode: 'readonly' as ExecutionMode,
    requires_consent_code: null,
    roles_allowed: [] as string[],
    data_scopes_read: ['knowledge_base'],
    data_scopes_write: [] as string[],
    side_effects: [] as string[],
    version: '1.0.0',
    cost_model: 'free' as CostModel,
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'internal' as const, endpoint: null },
    ui_entrypoints: ['/website/sot', '/sot'],
    audit_event_type: 'ARM_Z3_SOT_MODULE',
    status: 'active' as ActionStatus,
  },
  {
    action_code: 'ARM.Z3.SOT.TO_REGISTER',
    title_de: 'Zur Registrierung leiten',
    description_de: 'Leitet den Nutzer zur kostenlosen SoT-Registrierung',
    zones: ['Z3'] as ArmstrongZone[],
    module: null,
    risk_level: 'low' as RiskLevel,
    execution_mode: 'execute' as ExecutionMode,
    requires_consent_code: null,
    roles_allowed: [] as string[],
    data_scopes_read: [] as string[],
    data_scopes_write: [] as string[],
    side_effects: ['navigation'],
    version: '1.0.0',
    cost_model: 'free' as CostModel,
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'internal' as const, endpoint: null },
    ui_entrypoints: ['/website/sot', '/sot'],
    audit_event_type: 'ARM_Z3_SOT_REGISTER',
    status: 'active' as ActionStatus,
  },

  // ===========================================================================
  // ZONE 2 — BÜRO-MANAGER ACTIONS (Phase 6.1)
  // ===========================================================================

  // ---------------------------------------------------------------------------
  // 1. E-Mail & Kommunikation (MOD-02)
  // ---------------------------------------------------------------------------
  {
    action_code: 'ARM.MOD02.SEND_EMAIL',
    title_de: 'E-Mail senden',
    description_de: 'Sendet eine E-Mail über die Outbound Identity des Nutzers',
    zones: ['Z2'] as ArmstrongZone[],
    module: 'MOD-02',
    risk_level: 'medium' as RiskLevel,
    execution_mode: 'execute_with_confirmation' as ExecutionMode,
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['contacts', 'outbound_identity'],
    data_scopes_write: ['outbound_emails'],
    side_effects: ['sends_external_communication', 'credits_consumed'],
    version: '1.0.0',
    cost_model: 'metered' as CostModel,
    cost_unit: 'per_call' as CostUnit,
    cost_hint_cents: 5,
    api_contract: { type: 'edge_function' as const, endpoint: 'sot-system-mail-send' },
    ui_entrypoints: ['/portal/office'],
    audit_event_type: 'ARM_SEND_EMAIL',
    status: 'active' as ActionStatus,
  },
  {
    action_code: 'ARM.MOD02.DRAFT_EMAIL',
    title_de: 'E-Mail-Entwurf erstellen',
    description_de: 'Erstellt einen E-Mail-Entwurf ohne Versand',
    zones: ['Z2'] as ArmstrongZone[],
    module: 'MOD-02',
    risk_level: 'low' as RiskLevel,
    execution_mode: 'draft_only' as ExecutionMode,
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['contacts', 'outbound_identity'],
    data_scopes_write: ['email_drafts'],
    side_effects: [],
    version: '1.0.0',
    cost_model: 'free' as CostModel,
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'internal' as const, endpoint: null },
    ui_entrypoints: ['/portal/office'],
    audit_event_type: 'ARM_DRAFT_EMAIL',
    status: 'active' as ActionStatus,
  },
  {
    action_code: 'ARM.MOD02.REPLY_EMAIL',
    title_de: 'E-Mail beantworten',
    description_de: 'Verfasst und sendet eine Antwort auf eine empfangene E-Mail',
    zones: ['Z2'] as ArmstrongZone[],
    module: 'MOD-02',
    risk_level: 'medium' as RiskLevel,
    execution_mode: 'execute_with_confirmation' as ExecutionMode,
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['contacts', 'inbound_emails', 'outbound_identity'],
    data_scopes_write: ['outbound_emails'],
    side_effects: ['sends_external_communication', 'credits_consumed'],
    version: '1.0.0',
    cost_model: 'metered' as CostModel,
    cost_unit: 'per_call' as CostUnit,
    cost_hint_cents: 5,
    api_contract: { type: 'edge_function' as const, endpoint: 'sot-system-mail-send' },
    ui_entrypoints: ['/portal/office'],
    audit_event_type: 'ARM_REPLY_EMAIL',
    status: 'active' as ActionStatus,
  },
  {
    action_code: 'ARM.MOD02.SEND_BULK_EMAIL',
    title_de: 'Serien-E-Mail senden',
    description_de: 'Sendet eine DSGVO-konforme Serien-E-Mail an eine Kontaktgruppe',
    zones: ['Z2'] as ArmstrongZone[],
    module: 'MOD-02',
    risk_level: 'high' as RiskLevel,
    execution_mode: 'execute_with_confirmation' as ExecutionMode,
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['contacts', 'outbound_identity', 'contact_permissions'],
    data_scopes_write: ['outbound_emails', 'email_campaign_log'],
    side_effects: ['sends_external_communication', 'credits_consumed'],
    version: '1.0.0',
    cost_model: 'metered' as CostModel,
    cost_unit: 'per_recipient' as CostUnit,
    cost_hint_cents: 3,
    api_contract: { type: 'edge_function' as const, endpoint: 'sot-system-mail-send' },
    ui_entrypoints: ['/portal/office'],
    audit_event_type: 'ARM_SEND_BULK_EMAIL',
    status: 'active' as ActionStatus,
  },

  // ---------------------------------------------------------------------------
  // 2. Kalender & Terminverwaltung (MOD-02)
  // ---------------------------------------------------------------------------
  {
    action_code: 'ARM.MOD02.CREATE_APPOINTMENT',
    title_de: 'Termin anlegen',
    description_de: 'Legt einen neuen Termin im Kalender an',
    zones: ['Z2'] as ArmstrongZone[],
    module: 'MOD-02',
    risk_level: 'low' as RiskLevel,
    execution_mode: 'execute_with_confirmation' as ExecutionMode,
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['calendar_events', 'contacts'],
    data_scopes_write: ['calendar_events'],
    side_effects: [],
    version: '1.0.0',
    cost_model: 'free' as CostModel,
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'internal' as const, endpoint: null },
    ui_entrypoints: ['/portal/office'],
    audit_event_type: 'ARM_CREATE_APPOINTMENT',
    status: 'active' as ActionStatus,
  },
  {
    action_code: 'ARM.MOD02.RESCHEDULE_APPOINTMENT',
    title_de: 'Termin verschieben',
    description_de: 'Verschiebt einen bestehenden Termin auf einen neuen Zeitpunkt',
    zones: ['Z2'] as ArmstrongZone[],
    module: 'MOD-02',
    risk_level: 'medium' as RiskLevel,
    execution_mode: 'execute_with_confirmation' as ExecutionMode,
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['calendar_events', 'contacts'],
    data_scopes_write: ['calendar_events'],
    side_effects: ['sends_external_communication'],
    version: '1.0.0',
    cost_model: 'free' as CostModel,
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'internal' as const, endpoint: null },
    ui_entrypoints: ['/portal/office'],
    audit_event_type: 'ARM_RESCHEDULE_APPOINTMENT',
    status: 'active' as ActionStatus,
  },
  {
    action_code: 'ARM.MOD02.CANCEL_APPOINTMENT',
    title_de: 'Termin absagen',
    description_de: 'Sagt einen Termin ab und benachrichtigt optional die Teilnehmer',
    zones: ['Z2'] as ArmstrongZone[],
    module: 'MOD-02',
    risk_level: 'medium' as RiskLevel,
    execution_mode: 'execute_with_confirmation' as ExecutionMode,
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['calendar_events', 'contacts'],
    data_scopes_write: ['calendar_events'],
    side_effects: ['sends_external_communication'],
    version: '1.0.0',
    cost_model: 'free' as CostModel,
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'internal' as const, endpoint: null },
    ui_entrypoints: ['/portal/office'],
    audit_event_type: 'ARM_CANCEL_APPOINTMENT',
    status: 'active' as ActionStatus,
  },
  {
    action_code: 'ARM.MOD02.SCHEDULE_VIDEOCALL',
    title_de: 'Videocall planen',
    description_de: 'Plant einen Videocall und versendet die Einladung mit Link',
    zones: ['Z2'] as ArmstrongZone[],
    module: 'MOD-02',
    risk_level: 'medium' as RiskLevel,
    execution_mode: 'execute_with_confirmation' as ExecutionMode,
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['calendar_events', 'contacts', 'outbound_identity'],
    data_scopes_write: ['calendar_events', 'video_sessions'],
    side_effects: ['sends_external_communication', 'credits_consumed'],
    version: '1.0.0',
    cost_model: 'metered' as CostModel,
    cost_unit: 'per_call' as CostUnit,
    cost_hint_cents: 10,
    api_contract: { type: 'edge_function' as const, endpoint: 'sot-videocall-session' },
    ui_entrypoints: ['/portal/office'],
    audit_event_type: 'ARM_SCHEDULE_VIDEOCALL',
    status: 'active' as ActionStatus,
  },
  {
    action_code: 'ARM.MOD02.DAILY_BRIEFING',
    title_de: 'Tagesübersicht',
    description_de: 'Zeigt Termine, offene Tasks und Fälligkeiten des Tages',
    zones: ['Z2'] as ArmstrongZone[],
    module: 'MOD-02',
    risk_level: 'low' as RiskLevel,
    execution_mode: 'readonly' as ExecutionMode,
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['calendar_events', 'task_widgets', 'inbound_emails'],
    data_scopes_write: [],
    side_effects: [],
    version: '1.0.0',
    cost_model: 'free' as CostModel,
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'internal' as const, endpoint: null },
    ui_entrypoints: ['/portal/office'],
    audit_event_type: 'ARM_DAILY_BRIEFING_OFFICE',
    status: 'active' as ActionStatus,
  },

  // ---------------------------------------------------------------------------
  // 3. Kontaktverwaltung (MOD-02)
  // ---------------------------------------------------------------------------
  {
    action_code: 'ARM.MOD02.CREATE_CONTACT',
    title_de: 'Kontakt anlegen',
    description_de: 'Legt einen neuen Kontakt im Kontaktbuch an',
    zones: ['Z2'] as ArmstrongZone[],
    module: 'MOD-02',
    risk_level: 'low' as RiskLevel,
    execution_mode: 'execute_with_confirmation' as ExecutionMode,
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['contacts'],
    data_scopes_write: ['contacts'],
    side_effects: [],
    version: '1.0.0',
    cost_model: 'free' as CostModel,
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'internal' as const, endpoint: null },
    ui_entrypoints: ['/portal/office'],
    audit_event_type: 'ARM_CREATE_CONTACT',
    status: 'active' as ActionStatus,
  },
  {
    action_code: 'ARM.MOD02.SEARCH_CONTACT',
    title_de: 'Kontakt suchen',
    description_de: 'Durchsucht das Kontaktbuch nach Name, E-Mail oder Firma',
    zones: ['Z2'] as ArmstrongZone[],
    module: 'MOD-02',
    risk_level: 'low' as RiskLevel,
    execution_mode: 'readonly' as ExecutionMode,
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['contacts'],
    data_scopes_write: [],
    side_effects: [],
    version: '1.0.0',
    cost_model: 'free' as CostModel,
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'internal' as const, endpoint: null },
    ui_entrypoints: ['/portal/office'],
    audit_event_type: 'ARM_SEARCH_CONTACT',
    status: 'active' as ActionStatus,
  },
  {
    action_code: 'ARM.MOD02.ADD_CONTACT_NOTE',
    title_de: 'Kontakt-Notiz hinzufügen',
    description_de: 'Fügt eine Notiz zu einem bestehenden Kontakt hinzu',
    zones: ['Z2'] as ArmstrongZone[],
    module: 'MOD-02',
    risk_level: 'low' as RiskLevel,
    execution_mode: 'execute' as ExecutionMode,
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['contacts'],
    data_scopes_write: ['contact_notes'],
    side_effects: [],
    version: '1.0.0',
    cost_model: 'free' as CostModel,
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'internal' as const, endpoint: null },
    ui_entrypoints: ['/portal/office'],
    audit_event_type: 'ARM_ADD_CONTACT_NOTE',
    status: 'active' as ActionStatus,
  },
  {
    action_code: 'ARM.MOD02.LOG_INTERACTION',
    title_de: 'Interaktion protokollieren',
    description_de: 'Protokolliert ein Gespräch oder eine Interaktion bei einem Kontakt',
    zones: ['Z2'] as ArmstrongZone[],
    module: 'MOD-02',
    risk_level: 'low' as RiskLevel,
    execution_mode: 'execute' as ExecutionMode,
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['contacts'],
    data_scopes_write: ['contact_interactions'],
    side_effects: [],
    version: '1.0.0',
    cost_model: 'free' as CostModel,
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'internal' as const, endpoint: null },
    ui_entrypoints: ['/portal/office'],
    audit_event_type: 'ARM_LOG_INTERACTION',
    status: 'active' as ActionStatus,
  },

  // ---------------------------------------------------------------------------
  // 4. Immobilienverwaltung (MOD-04)
  // ---------------------------------------------------------------------------
  {
    action_code: 'ARM.MOD04.CREATE_LEASE',
    title_de: 'Mietvertrag anlegen',
    description_de: 'Legt einen neuen Mietvertrag für eine Einheit an',
    zones: ['Z2'] as ArmstrongZone[],
    module: 'MOD-04',
    risk_level: 'medium' as RiskLevel,
    execution_mode: 'execute_with_confirmation' as ExecutionMode,
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['properties', 'units', 'contacts'],
    data_scopes_write: ['leases'],
    side_effects: [],
    version: '1.0.0',
    cost_model: 'free' as CostModel,
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'internal' as const, endpoint: null },
    ui_entrypoints: ['/portal/immobilien'],
    audit_event_type: 'ARM_CREATE_LEASE',
    status: 'active' as ActionStatus,
  },
  {
    action_code: 'ARM.MOD04.CREATE_TENANT',
    title_de: 'Mieter anlegen',
    description_de: 'Legt einen neuen Mieter an und verknüpft ihn mit einer Einheit',
    zones: ['Z2'] as ArmstrongZone[],
    module: 'MOD-04',
    risk_level: 'medium' as RiskLevel,
    execution_mode: 'execute_with_confirmation' as ExecutionMode,
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['properties', 'units', 'contacts'],
    data_scopes_write: ['tenants', 'leases'],
    side_effects: [],
    version: '1.0.0',
    cost_model: 'free' as CostModel,
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'internal' as const, endpoint: null },
    ui_entrypoints: ['/portal/immobilien'],
    audit_event_type: 'ARM_CREATE_TENANT',
    status: 'active' as ActionStatus,
  },
  {
    action_code: 'ARM.MOD04.DRAFT_RENT_ADJUSTMENT',
    title_de: 'Mieterhöhungsschreiben vorbereiten',
    description_de: 'Bereitet ein Mieterhöhungsschreiben auf Basis des Mietspiegels vor',
    zones: ['Z2'] as ArmstrongZone[],
    module: 'MOD-04',
    risk_level: 'medium' as RiskLevel,
    execution_mode: 'draft_only' as ExecutionMode,
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['properties', 'units', 'leases', 'tenants'],
    data_scopes_write: ['letter_drafts'],
    side_effects: [],
    version: '1.0.0',
    cost_model: 'free' as CostModel,
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'internal' as const, endpoint: null },
    ui_entrypoints: ['/portal/immobilien'],
    audit_event_type: 'ARM_DRAFT_RENT_ADJUSTMENT',
    status: 'active' as ActionStatus,
  },
  {
    action_code: 'ARM.MOD04.DRAFT_RENT_REMINDER',
    title_de: 'Mahnschreiben vorbereiten',
    description_de: 'Bereitet ein Mahnschreiben bei Mietrückstand vor und erstellt Widget zur Freigabe',
    zones: ['Z2'] as ArmstrongZone[],
    module: 'MOD-04',
    risk_level: 'high' as RiskLevel,
    execution_mode: 'execute_with_confirmation' as ExecutionMode,
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['properties', 'units', 'leases', 'tenants', 'rent_payments'],
    data_scopes_write: ['letter_drafts', 'task_widgets'],
    side_effects: ['sends_external_communication', 'credits_consumed'],
    version: '1.0.0',
    cost_model: 'metered' as CostModel,
    cost_unit: 'per_call' as CostUnit,
    cost_hint_cents: 15,
    api_contract: { type: 'edge_function' as const, endpoint: 'sot-letter-send' },
    ui_entrypoints: ['/portal/immobilien'],
    audit_event_type: 'ARM_DRAFT_RENT_REMINDER',
    status: 'active' as ActionStatus,
  },
  {
    action_code: 'ARM.MOD04.RUN_NK_ABRECHNUNG',
    title_de: 'Nebenkostenabrechnung erstellen',
    description_de: 'Berechnet die Nebenkostenabrechnung und erstellt einen Entwurf zur Freigabe',
    zones: ['Z2'] as ArmstrongZone[],
    module: 'MOD-04',
    risk_level: 'high' as RiskLevel,
    execution_mode: 'execute_with_confirmation' as ExecutionMode,
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['properties', 'units', 'leases', 'tenants', 'operating_costs'],
    data_scopes_write: ['nk_abrechnungen', 'task_widgets'],
    side_effects: ['sends_external_communication', 'credits_consumed'],
    version: '1.0.0',
    cost_model: 'metered' as CostModel,
    cost_unit: 'per_call' as CostUnit,
    cost_hint_cents: 25,
    api_contract: { type: 'edge_function' as const, endpoint: 'sot-armstrong-advisor' },
    ui_entrypoints: ['/portal/immobilien'],
    audit_event_type: 'ARM_RUN_NK_ABRECHNUNG',
    status: 'active' as ActionStatus,
  },
  {
    action_code: 'ARM.MOD04.DRAFT_TENANT_LETTER',
    title_de: 'Mieterschreiben vorbereiten',
    description_de: 'Bereitet ein allgemeines Schreiben an Mieter vor (Betriebskosten, Hausverwaltung etc.)',
    zones: ['Z2'] as ArmstrongZone[],
    module: 'MOD-04',
    risk_level: 'low' as RiskLevel,
    execution_mode: 'draft_only' as ExecutionMode,
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['properties', 'units', 'leases', 'tenants'],
    data_scopes_write: ['letter_drafts'],
    side_effects: [],
    version: '1.0.0',
    cost_model: 'free' as CostModel,
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'internal' as const, endpoint: null },
    ui_entrypoints: ['/portal/immobilien'],
    audit_event_type: 'ARM_DRAFT_TENANT_LETTER',
    status: 'active' as ActionStatus,
  },

  // ---------------------------------------------------------------------------
  // 5. Finanzierung (MOD-07)
  // ---------------------------------------------------------------------------
  {
    action_code: 'ARM.MOD07.CREATE_FINANCE_REQUEST',
    title_de: 'Finanzierungsanfrage erstellen',
    description_de: 'Erstellt eine Finanzierungsanfrage aus Selbstauskunft und Objektdaten',
    zones: ['Z2'] as ArmstrongZone[],
    module: 'MOD-07',
    risk_level: 'high' as RiskLevel,
    execution_mode: 'execute_with_confirmation' as ExecutionMode,
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['applicant_profiles', 'properties', 'units'],
    data_scopes_write: ['finance_requests', 'task_widgets'],
    side_effects: ['credits_consumed'],
    version: '1.0.0',
    cost_model: 'metered' as CostModel,
    cost_unit: 'per_call' as CostUnit,
    cost_hint_cents: 50,
    api_contract: { type: 'edge_function' as const, endpoint: 'sot-armstrong-advisor' },
    ui_entrypoints: ['/portal/finanzierung'],
    audit_event_type: 'ARM_CREATE_FINANCE_REQUEST',
    status: 'active' as ActionStatus,
  },
  {
    action_code: 'ARM.MOD07.CHECK_CREDITWORTHINESS',
    title_de: 'Bonität prüfen',
    description_de: 'Prüft die Bonität anhand des Haushaltsüberschusses',
    zones: ['Z2'] as ArmstrongZone[],
    module: 'MOD-07',
    risk_level: 'low' as RiskLevel,
    execution_mode: 'readonly' as ExecutionMode,
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['applicant_profiles', 'applicant_liabilities'],
    data_scopes_write: [],
    side_effects: [],
    version: '1.0.0',
    cost_model: 'free' as CostModel,
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'internal' as const, endpoint: null },
    ui_entrypoints: ['/portal/finanzierung'],
    audit_event_type: 'ARM_CHECK_CREDITWORTHINESS',
    status: 'active' as ActionStatus,
  },
  {
    action_code: 'ARM.MOD07.SUBMIT_TO_BANK',
    title_de: 'An Bank übermitteln',
    description_de: 'Übermittelt das Finanzierungspaket an einen Bankpartner',
    zones: ['Z2'] as ArmstrongZone[],
    module: 'MOD-07',
    risk_level: 'high' as RiskLevel,
    execution_mode: 'execute_with_confirmation' as ExecutionMode,
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['finance_requests', 'applicant_profiles', 'properties'],
    data_scopes_write: ['finance_submissions', 'task_widgets'],
    side_effects: ['sends_external_communication', 'credits_consumed'],
    version: '1.0.0',
    cost_model: 'metered' as CostModel,
    cost_unit: 'per_call' as CostUnit,
    cost_hint_cents: 100,
    api_contract: { type: 'edge_function' as const, endpoint: 'sot-system-mail-send' },
    ui_entrypoints: ['/portal/finanzierung'],
    audit_event_type: 'ARM_SUBMIT_TO_BANK',
    status: 'active' as ActionStatus,
  },

  // ---------------------------------------------------------------------------
  // 6. Tagesgeschäft & Produktivität (MOD-00)
  // ---------------------------------------------------------------------------
  {
    action_code: 'ARM.MOD00.DAILY_BRIEFING',
    title_de: 'Morgen-Briefing',
    description_de: 'Zeigt Tagesübersicht: Termine, Fälligkeiten, offene Widgets, neue E-Mails',
    zones: ['Z2'] as ArmstrongZone[],
    module: 'MOD-00',
    risk_level: 'low' as RiskLevel,
    execution_mode: 'readonly' as ExecutionMode,
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['calendar_events', 'task_widgets', 'inbound_emails', 'reminders'],
    data_scopes_write: [],
    side_effects: [],
    version: '1.0.0',
    cost_model: 'free' as CostModel,
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'internal' as const, endpoint: null },
    ui_entrypoints: ['/portal'],
    audit_event_type: 'ARM_DAILY_BRIEFING',
    status: 'active' as ActionStatus,
  },
  {
    action_code: 'ARM.MOD00.WEEKLY_SUMMARY',
    title_de: 'Wochenrückblick',
    description_de: 'Erstellt einen Rückblick: erledigte Tasks, KPIs, Ausblick nächste Woche',
    zones: ['Z2'] as ArmstrongZone[],
    module: 'MOD-00',
    risk_level: 'low' as RiskLevel,
    execution_mode: 'readonly' as ExecutionMode,
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['task_widgets', 'calendar_events', 'armstrong_action_runs'],
    data_scopes_write: [],
    side_effects: [],
    version: '1.0.0',
    cost_model: 'free' as CostModel,
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'internal' as const, endpoint: null },
    ui_entrypoints: ['/portal'],
    audit_event_type: 'ARM_WEEKLY_SUMMARY',
    status: 'active' as ActionStatus,
  },
  {
    action_code: 'ARM.MOD00.PRIORITIZE_INBOX',
    title_de: 'Posteingang priorisieren',
    description_de: 'Sortiert und priorisiert den Posteingang KI-gestützt',
    zones: ['Z2'] as ArmstrongZone[],
    module: 'MOD-00',
    risk_level: 'low' as RiskLevel,
    execution_mode: 'readonly' as ExecutionMode,
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['inbound_emails', 'contacts', 'calendar_events'],
    data_scopes_write: [],
    side_effects: [],
    version: '1.0.0',
    cost_model: 'free' as CostModel,
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'internal' as const, endpoint: null },
    ui_entrypoints: ['/portal'],
    audit_event_type: 'ARM_PRIORITIZE_INBOX',
    status: 'active' as ActionStatus,
  },
  {
    action_code: 'ARM.MOD00.GENERATE_REPORT',
    title_de: 'Bericht erstellen',
    description_de: 'Erstellt einen Bericht zu Portfolio, Finanzen oder Vermietung',
    zones: ['Z2'] as ArmstrongZone[],
    module: 'MOD-00',
    risk_level: 'medium' as RiskLevel,
    execution_mode: 'execute_with_confirmation' as ExecutionMode,
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['properties', 'units', 'leases', 'finance_requests', 'analytics'],
    data_scopes_write: ['reports', 'task_widgets'],
    side_effects: ['credits_consumed'],
    version: '1.0.0',
    cost_model: 'metered' as CostModel,
    cost_unit: 'per_call' as CostUnit,
    cost_hint_cents: 20,
    api_contract: { type: 'edge_function' as const, endpoint: 'sot-armstrong-advisor' },
    ui_entrypoints: ['/portal'],
    audit_event_type: 'ARM_GENERATE_REPORT',
    status: 'active' as ActionStatus,
  },

  // ---------------------------------------------------------------------------
  // 7. Vertrieb & Akquise (MOD-12)
  // ---------------------------------------------------------------------------
  {
    action_code: 'ARM.MOD12.DRAFT_ACQ_EMAIL',
    title_de: 'Akquise-Anschreiben erstellen',
    description_de: 'Erstellt ein Akquise-Anschreiben für ein Mandat',
    zones: ['Z2'] as ArmstrongZone[],
    module: 'MOD-12',
    risk_level: 'low' as RiskLevel,
    execution_mode: 'draft_only' as ExecutionMode,
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['acq_mandates', 'contacts', 'outbound_identity'],
    data_scopes_write: ['email_drafts'],
    side_effects: [],
    version: '1.0.0',
    cost_model: 'free' as CostModel,
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'internal' as const, endpoint: null },
    ui_entrypoints: ['/portal/akquise'],
    audit_event_type: 'ARM_DRAFT_ACQ_EMAIL',
    status: 'active' as ActionStatus,
  },
  {
    action_code: 'ARM.MOD12.ANALYZE_OFFER',
    title_de: 'Angebot bewerten',
    description_de: 'Bewertet ein eingehendes Angebot als Bestand oder Aufteiler',
    zones: ['Z2'] as ArmstrongZone[],
    module: 'MOD-12',
    risk_level: 'low' as RiskLevel,
    execution_mode: 'readonly' as ExecutionMode,
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['acq_offers', 'acq_mandates'],
    data_scopes_write: [],
    side_effects: [],
    version: '1.0.0',
    cost_model: 'free' as CostModel,
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'internal' as const, endpoint: null },
    ui_entrypoints: ['/portal/akquise'],
    audit_event_type: 'ARM_ANALYZE_OFFER',
    status: 'active' as ActionStatus,
  },
  {
    action_code: 'ARM.MOD12.CREATE_MANDATE',
    title_de: 'Akquise-Mandat anlegen',
    description_de: 'Legt ein neues Akquise-Mandat im System an',
    zones: ['Z2'] as ArmstrongZone[],
    module: 'MOD-12',
    risk_level: 'medium' as RiskLevel,
    execution_mode: 'execute_with_confirmation' as ExecutionMode,
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['contacts'],
    data_scopes_write: ['acq_mandates'],
    side_effects: [],
    version: '1.0.0',
    cost_model: 'free' as CostModel,
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'internal' as const, endpoint: null },
    ui_entrypoints: ['/portal/akquise'],
    audit_event_type: 'ARM_CREATE_MANDATE',
    status: 'active' as ActionStatus,
  },

  // ---------------------------------------------------------------------------
  // 8. Sanierung (MOD-16)
  // ---------------------------------------------------------------------------
  {
    action_code: 'ARM.MOD16.DRAFT_TENDER',
    title_de: 'Ausschreibung vorbereiten',
    description_de: 'Bereitet eine Ausschreibung für Handwerkerleistungen vor',
    zones: ['Z2'] as ArmstrongZone[],
    module: 'MOD-16',
    risk_level: 'low' as RiskLevel,
    execution_mode: 'draft_only' as ExecutionMode,
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['properties', 'units', 'renovation_projects'],
    data_scopes_write: ['tender_drafts'],
    side_effects: [],
    version: '1.0.0',
    cost_model: 'free' as CostModel,
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'internal' as const, endpoint: null },
    ui_entrypoints: ['/portal/sanierung'],
    audit_event_type: 'ARM_DRAFT_TENDER',
    status: 'active' as ActionStatus,
  },
  {
    action_code: 'ARM.MOD16.COMPARE_OFFERS',
    title_de: 'Handwerkerangebote vergleichen',
    description_de: 'Vergleicht eingegangene Handwerkerangebote und gibt eine Empfehlung',
    zones: ['Z2'] as ArmstrongZone[],
    module: 'MOD-16',
    risk_level: 'low' as RiskLevel,
    execution_mode: 'readonly' as ExecutionMode,
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['renovation_projects', 'contractor_offers'],
    data_scopes_write: [],
    side_effects: [],
    version: '1.0.0',
    cost_model: 'free' as CostModel,
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'internal' as const, endpoint: null },
    ui_entrypoints: ['/portal/sanierung'],
    audit_event_type: 'ARM_COMPARE_OFFERS',
    status: 'active' as ActionStatus,
  },
  {
    action_code: 'ARM.MOD16.COMMISSION_CONTRACTOR',
    title_de: 'Handwerker beauftragen',
    description_de: 'Beauftragt einen Handwerker per E-Mail-Versand',
    zones: ['Z2'] as ArmstrongZone[],
    module: 'MOD-16',
    risk_level: 'high' as RiskLevel,
    execution_mode: 'execute_with_confirmation' as ExecutionMode,
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['renovation_projects', 'contractor_offers', 'contacts', 'outbound_identity'],
    data_scopes_write: ['contractor_commissions', 'task_widgets'],
    side_effects: ['sends_external_communication', 'credits_consumed'],
    version: '1.0.0',
    cost_model: 'metered' as CostModel,
    cost_unit: 'per_call' as CostUnit,
    cost_hint_cents: 10,
    api_contract: { type: 'edge_function' as const, endpoint: 'sot-system-mail-send' },
    ui_entrypoints: ['/portal/sanierung'],
    audit_event_type: 'ARM_COMMISSION_CONTRACTOR',
    status: 'active' as ActionStatus,
  },

  // ===========================================================================
  // MOD-06: VERKAUF (Sales Module)
  // ===========================================================================
  {
    action_code: 'ARM.MOD06.EXPLAIN_MODULE',
    title_de: 'Verkaufsmodul erklären',
    description_de: 'Erklärt Funktionen und Golden Path des Verkaufsmoduls',
    zones: ['Z2'] as ArmstrongZone[],
    module: 'MOD-06',
    risk_level: 'low' as RiskLevel,
    execution_mode: 'readonly' as ExecutionMode,
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['knowledge_base'],
    data_scopes_write: [],
    side_effects: [],
    version: '1.0.0',
    cost_model: 'free' as CostModel,
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'internal' as const, endpoint: null },
    ui_entrypoints: ['/portal/verkauf'],
    audit_event_type: 'ARM_MOD06_EXPLAIN',
    status: 'active' as ActionStatus,
  },
  {
    action_code: 'ARM.MOD06.GENERATE_EXPOSE',
    title_de: 'Exposé generieren',
    description_de: 'Erstellt ein Verkaufsexposé aus Objektdaten und Bildern',
    zones: ['Z2'] as ArmstrongZone[],
    module: 'MOD-06',
    risk_level: 'medium' as RiskLevel,
    execution_mode: 'execute_with_confirmation' as ExecutionMode,
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['properties', 'units', 'storage_nodes'],
    data_scopes_write: ['expose_drafts', 'task_widgets'],
    side_effects: ['credits_consumed'],
    version: '1.0.0',
    cost_model: 'metered' as CostModel,
    cost_unit: 'per_call' as CostUnit,
    cost_hint_cents: 15,
    api_contract: { type: 'edge_function' as const, endpoint: 'sot-armstrong-advisor' },
    ui_entrypoints: ['/portal/verkauf'],
    audit_event_type: 'ARM_MOD06_GENERATE_EXPOSE',
    status: 'active' as ActionStatus,
  },
  {
    action_code: 'ARM.MOD06.PUBLISH_LISTING',
    title_de: 'Inserat veröffentlichen',
    description_de: 'Veröffentlicht ein Verkaufsinserat auf dem Marktplatz',
    zones: ['Z2'] as ArmstrongZone[],
    module: 'MOD-06',
    risk_level: 'high' as RiskLevel,
    execution_mode: 'execute_with_confirmation' as ExecutionMode,
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['properties', 'expose_drafts'],
    data_scopes_write: ['listings_published', 'task_widgets'],
    side_effects: ['public_visibility'],
    version: '1.0.0',
    cost_model: 'free' as CostModel,
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'internal' as const, endpoint: null },
    ui_entrypoints: ['/portal/verkauf'],
    audit_event_type: 'ARM_MOD06_PUBLISH_LISTING',
    status: 'active' as ActionStatus,
  },
  {
    action_code: 'ARM.MOD06.UNPUBLISH_LISTING',
    title_de: 'Inserat deaktivieren',
    description_de: 'Nimmt ein veröffentlichtes Inserat vom Marktplatz',
    zones: ['Z2'] as ArmstrongZone[],
    module: 'MOD-06',
    risk_level: 'medium' as RiskLevel,
    execution_mode: 'execute_with_confirmation' as ExecutionMode,
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['listings_published'],
    data_scopes_write: ['listings_published'],
    side_effects: [],
    version: '1.0.0',
    cost_model: 'free' as CostModel,
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'internal' as const, endpoint: null },
    ui_entrypoints: ['/portal/verkauf'],
    audit_event_type: 'ARM_MOD06_UNPUBLISH_LISTING',
    status: 'active' as ActionStatus,
  },
  {
    action_code: 'ARM.MOD06.ANALYZE_MARKET_PRICE',
    title_de: 'Marktpreis analysieren',
    description_de: 'Analysiert den Marktpreis anhand von Vergleichsobjekten und Lage',
    zones: ['Z2'] as ArmstrongZone[],
    module: 'MOD-06',
    risk_level: 'low' as RiskLevel,
    execution_mode: 'readonly' as ExecutionMode,
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['properties', 'market_data'],
    data_scopes_write: [],
    side_effects: [],
    version: '1.0.0',
    cost_model: 'free' as CostModel,
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'internal' as const, endpoint: null },
    ui_entrypoints: ['/portal/verkauf'],
    audit_event_type: 'ARM_MOD06_ANALYZE_MARKET_PRICE',
    status: 'active' as ActionStatus,
  },

  // ===========================================================================
  // MOD-09: VERTRIEBSPARTNER (Immomanager)
  // ===========================================================================
  {
    action_code: 'ARM.MOD09.EXPLAIN_MODULE',
    title_de: 'Immomanager erklären',
    description_de: 'Erklärt Funktionen des Vertriebspartner-Moduls und Objektkatalog',
    zones: ['Z2'] as ArmstrongZone[],
    module: 'MOD-09',
    risk_level: 'low' as RiskLevel,
    execution_mode: 'readonly' as ExecutionMode,
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['knowledge_base'],
    data_scopes_write: [],
    side_effects: [],
    version: '1.0.0',
    cost_model: 'free' as CostModel,
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'internal' as const, endpoint: null },
    ui_entrypoints: ['/portal/partner'],
    audit_event_type: 'ARM_MOD09_EXPLAIN',
    status: 'active' as ActionStatus,
  },
  {
    action_code: 'ARM.MOD09.CREATE_PARTNER_PROFILE',
    title_de: 'Partnerprofil anlegen',
    description_de: 'Erstellt ein neues Vertriebspartner-Profil mit Provisionsdaten',
    zones: ['Z2'] as ArmstrongZone[],
    module: 'MOD-09',
    risk_level: 'medium' as RiskLevel,
    execution_mode: 'execute_with_confirmation' as ExecutionMode,
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['contacts'],
    data_scopes_write: ['partner_profiles'],
    side_effects: [],
    version: '1.0.0',
    cost_model: 'free' as CostModel,
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'internal' as const, endpoint: null },
    ui_entrypoints: ['/portal/partner'],
    audit_event_type: 'ARM_MOD09_CREATE_PARTNER',
    status: 'active' as ActionStatus,
  },
  {
    action_code: 'ARM.MOD09.VIEW_OBJECT_CATALOG',
    title_de: 'Objektkatalog einsehen',
    description_de: 'Zeigt verfügbare Objekte im Partnerkatalog mit Provisionsdetails',
    zones: ['Z2'] as ArmstrongZone[],
    module: 'MOD-09',
    risk_level: 'low' as RiskLevel,
    execution_mode: 'readonly' as ExecutionMode,
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['listings_published', 'partner_provisions'],
    data_scopes_write: [],
    side_effects: [],
    version: '1.0.0',
    cost_model: 'free' as CostModel,
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'internal' as const, endpoint: null },
    ui_entrypoints: ['/portal/partner'],
    audit_event_type: 'ARM_MOD09_VIEW_CATALOG',
    status: 'active' as ActionStatus,
  },
  {
    action_code: 'ARM.MOD09.RUN_PARTNER_SIMULATION',
    title_de: 'Kunden-Simulation durchführen',
    description_de: 'Führt eine Investment-Simulation für einen Beratungskunden durch',
    zones: ['Z2'] as ArmstrongZone[],
    module: 'MOD-09',
    risk_level: 'low' as RiskLevel,
    execution_mode: 'readonly' as ExecutionMode,
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['listings_published', 'investment_engine'],
    data_scopes_write: [],
    side_effects: [],
    version: '1.0.0',
    cost_model: 'free' as CostModel,
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'tool_call' as const, endpoint: null, tool_name: 'calculate_investment' },
    ui_entrypoints: ['/portal/partner'],
    audit_event_type: 'ARM_MOD09_PARTNER_SIMULATION',
    status: 'active' as ActionStatus,
  },
  {
    action_code: 'ARM.MOD09.DRAFT_PARTNER_OFFER',
    title_de: 'Kundenangebot erstellen',
    description_de: 'Erstellt ein individuelles Angebot für einen Beratungskunden',
    zones: ['Z2'] as ArmstrongZone[],
    module: 'MOD-09',
    risk_level: 'low' as RiskLevel,
    execution_mode: 'draft_only' as ExecutionMode,
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['listings_published', 'investment_engine', 'contacts'],
    data_scopes_write: ['partner_offer_drafts'],
    side_effects: [],
    version: '1.0.0',
    cost_model: 'free' as CostModel,
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'internal' as const, endpoint: null },
    ui_entrypoints: ['/portal/partner'],
    audit_event_type: 'ARM_MOD09_DRAFT_OFFER',
    status: 'active' as ActionStatus,
  },

  // ===========================================================================
  // MOD-10: LEADMANAGER
  // ===========================================================================
  {
    action_code: 'ARM.MOD10.EXPLAIN_MODULE',
    title_de: 'Leadmanager erklären',
    description_de: 'Erklärt die Lead-Pipeline und Zuweisungslogik',
    zones: ['Z2'] as ArmstrongZone[],
    module: 'MOD-10',
    risk_level: 'low' as RiskLevel,
    execution_mode: 'readonly' as ExecutionMode,
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['knowledge_base'],
    data_scopes_write: [],
    side_effects: [],
    version: '1.0.0',
    cost_model: 'free' as CostModel,
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'internal' as const, endpoint: null },
    ui_entrypoints: ['/portal/leads'],
    audit_event_type: 'ARM_MOD10_EXPLAIN',
    status: 'active' as ActionStatus,
  },
  {
    action_code: 'ARM.MOD10.VIEW_LEAD_PIPELINE',
    title_de: 'Lead-Pipeline anzeigen',
    description_de: 'Zeigt den aktuellen Stand der Lead-Pipeline mit Konversionsraten',
    zones: ['Z2'] as ArmstrongZone[],
    module: 'MOD-10',
    risk_level: 'low' as RiskLevel,
    execution_mode: 'readonly' as ExecutionMode,
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['leads', 'lead_pipeline'],
    data_scopes_write: [],
    side_effects: [],
    version: '1.0.0',
    cost_model: 'free' as CostModel,
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'internal' as const, endpoint: null },
    ui_entrypoints: ['/portal/leads'],
    audit_event_type: 'ARM_MOD10_VIEW_PIPELINE',
    status: 'active' as ActionStatus,
  },
  {
    action_code: 'ARM.MOD10.QUALIFY_LEAD',
    title_de: 'Lead qualifizieren',
    description_de: 'Bewertet und qualifiziert einen Lead anhand definierter Kriterien',
    zones: ['Z2'] as ArmstrongZone[],
    module: 'MOD-10',
    risk_level: 'low' as RiskLevel,
    execution_mode: 'execute' as ExecutionMode,
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['leads'],
    data_scopes_write: ['leads'],
    side_effects: [],
    version: '1.0.0',
    cost_model: 'free' as CostModel,
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'internal' as const, endpoint: null },
    ui_entrypoints: ['/portal/leads'],
    audit_event_type: 'ARM_MOD10_QUALIFY_LEAD',
    status: 'active' as ActionStatus,
  },
  {
    action_code: 'ARM.MOD10.ASSIGN_LEAD',
    title_de: 'Lead zuweisen',
    description_de: 'Weist einen Lead einem Berater oder Vertriebspartner zu',
    zones: ['Z2'] as ArmstrongZone[],
    module: 'MOD-10',
    risk_level: 'medium' as RiskLevel,
    execution_mode: 'execute_with_confirmation' as ExecutionMode,
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['leads', 'profiles'],
    data_scopes_write: ['leads', 'task_widgets'],
    side_effects: ['sends_notification'],
    version: '1.0.0',
    cost_model: 'free' as CostModel,
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'internal' as const, endpoint: null },
    ui_entrypoints: ['/portal/leads'],
    audit_event_type: 'ARM_MOD10_ASSIGN_LEAD',
    status: 'active' as ActionStatus,
  },
  {
    action_code: 'ARM.MOD10.CREATE_DEAL',
    title_de: 'Deal aus Lead erstellen',
    description_de: 'Konvertiert einen qualifizierten Lead in einen Deal/Vorgang',
    zones: ['Z2'] as ArmstrongZone[],
    module: 'MOD-10',
    risk_level: 'medium' as RiskLevel,
    execution_mode: 'execute_with_confirmation' as ExecutionMode,
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['leads', 'contacts'],
    data_scopes_write: ['deals'],
    side_effects: [],
    version: '1.0.0',
    cost_model: 'free' as CostModel,
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'internal' as const, endpoint: null },
    ui_entrypoints: ['/portal/leads'],
    audit_event_type: 'ARM_MOD10_CREATE_DEAL',
    status: 'active' as ActionStatus,
  },

  // ===========================================================================
  // MOD-11: FINANZIERUNGSMANAGER
  // ===========================================================================
  {
    action_code: 'ARM.MOD11.EXPLAIN_MODULE',
    title_de: 'Finanzierungsmanager erklären',
    description_de: 'Erklärt den Finanzierungsmanager: Fälle, Magic Intake, Einreichung',
    zones: ['Z2'] as ArmstrongZone[],
    module: 'MOD-11',
    risk_level: 'low' as RiskLevel,
    execution_mode: 'readonly' as ExecutionMode,
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['knowledge_base'],
    data_scopes_write: [],
    side_effects: [],
    version: '1.0.0',
    cost_model: 'free' as CostModel,
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'internal' as const, endpoint: null },
    ui_entrypoints: ['/portal/finanzierungsmanager'],
    audit_event_type: 'ARM_MOD11_EXPLAIN',
    status: 'active' as ActionStatus,
  },
  {
    action_code: 'ARM.MOD11.CREATE_CASE',
    title_de: 'Finanzierungsfall anlegen',
    description_de: 'Legt einen neuen Finanzierungsfall mit Kundendaten an',
    zones: ['Z2'] as ArmstrongZone[],
    module: 'MOD-11',
    risk_level: 'medium' as RiskLevel,
    execution_mode: 'execute_with_confirmation' as ExecutionMode,
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['contacts', 'applicant_profiles'],
    data_scopes_write: ['finance_requests'],
    side_effects: [],
    version: '1.0.0',
    cost_model: 'free' as CostModel,
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'internal' as const, endpoint: null },
    ui_entrypoints: ['/portal/finanzierungsmanager'],
    audit_event_type: 'ARM_MOD11_CREATE_CASE',
    status: 'active' as ActionStatus,
  },
  {
    action_code: 'ARM.MOD11.MAGIC_INTAKE',
    title_de: 'Magic Intake starten',
    description_de: 'Startet den KI-gestützten Selbstauskunft-Import aus Dokumenten',
    zones: ['Z2'] as ArmstrongZone[],
    module: 'MOD-11',
    risk_level: 'medium' as RiskLevel,
    execution_mode: 'execute_with_confirmation' as ExecutionMode,
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['storage_nodes', 'applicant_profiles'],
    data_scopes_write: ['applicant_profiles', 'task_widgets'],
    side_effects: ['credits_consumed'],
    version: '1.0.0',
    cost_model: 'metered' as CostModel,
    cost_unit: 'per_call' as CostUnit,
    cost_hint_cents: 20,
    api_contract: { type: 'edge_function' as const, endpoint: 'sot-armstrong-advisor' },
    ui_entrypoints: ['/portal/finanzierungsmanager'],
    audit_event_type: 'ARM_MOD11_MAGIC_INTAKE',
    status: 'active' as ActionStatus,
  },
  {
    action_code: 'ARM.MOD11.PREPARE_SUBMISSION',
    title_de: 'Einreichung vorbereiten',
    description_de: 'Bereitet ein Finanzierungspaket zur Bankeinreichung vor',
    zones: ['Z2'] as ArmstrongZone[],
    module: 'MOD-11',
    risk_level: 'high' as RiskLevel,
    execution_mode: 'execute_with_confirmation' as ExecutionMode,
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['finance_requests', 'applicant_profiles', 'storage_nodes'],
    data_scopes_write: ['submission_packages', 'task_widgets'],
    side_effects: ['credits_consumed'],
    version: '1.0.0',
    cost_model: 'metered' as CostModel,
    cost_unit: 'per_call' as CostUnit,
    cost_hint_cents: 15,
    api_contract: { type: 'edge_function' as const, endpoint: 'sot-armstrong-advisor' },
    ui_entrypoints: ['/portal/finanzierungsmanager'],
    audit_event_type: 'ARM_MOD11_PREPARE_SUBMISSION',
    status: 'active' as ActionStatus,
  },
  {
    action_code: 'ARM.MOD11.TRACK_PROVISION',
    title_de: 'Provision tracken',
    description_de: 'Zeigt den Status offener Tippgeber-Provisionen',
    zones: ['Z2'] as ArmstrongZone[],
    module: 'MOD-11',
    risk_level: 'low' as RiskLevel,
    execution_mode: 'readonly' as ExecutionMode,
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['provisions', 'finance_requests'],
    data_scopes_write: [],
    side_effects: [],
    version: '1.0.0',
    cost_model: 'free' as CostModel,
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'internal' as const, endpoint: null },
    ui_entrypoints: ['/portal/finanzierungsmanager'],
    audit_event_type: 'ARM_MOD11_TRACK_PROVISION',
    status: 'active' as ActionStatus,
  },

  // ===========================================================================
  // MOD-13: PROJEKTE (Erweiterungen)
  // ===========================================================================
  {
    action_code: 'ARM.MOD13.CALCULATE_AUFTEILER',
    title_de: 'Aufteiler-Kalkulation',
    description_de: 'Berechnet die Aufteiler-Kalkulation für ein Bauträgerprojekt',
    zones: ['Z2'] as ArmstrongZone[],
    module: 'MOD-13',
    risk_level: 'low' as RiskLevel,
    execution_mode: 'readonly' as ExecutionMode,
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['projects', 'units', 'investment_engine'],
    data_scopes_write: [],
    side_effects: [],
    version: '1.0.0',
    cost_model: 'free' as CostModel,
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'tool_call' as const, endpoint: null, tool_name: 'calculate_investment' },
    ui_entrypoints: ['/portal/projekte'],
    audit_event_type: 'ARM_MOD13_CALC_AUFTEILER',
    status: 'active' as ActionStatus,
  },
  {
    action_code: 'ARM.MOD13.GENERATE_SALES_REPORT',
    title_de: 'Verkaufsstandsbericht',
    description_de: 'Erstellt einen Verkaufsstandsbericht für ein Projekt',
    zones: ['Z2'] as ArmstrongZone[],
    module: 'MOD-13',
    risk_level: 'medium' as RiskLevel,
    execution_mode: 'execute_with_confirmation' as ExecutionMode,
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['projects', 'units', 'reservations', 'sales_data'],
    data_scopes_write: ['report_drafts', 'task_widgets'],
    side_effects: ['credits_consumed'],
    version: '1.0.0',
    cost_model: 'metered' as CostModel,
    cost_unit: 'per_call' as CostUnit,
    cost_hint_cents: 10,
    api_contract: { type: 'edge_function' as const, endpoint: 'sot-armstrong-advisor' },
    ui_entrypoints: ['/portal/projekte'],
    audit_event_type: 'ARM_MOD13_SALES_REPORT',
    status: 'active' as ActionStatus,
  },
  {
    action_code: 'ARM.MOD13.DRAFT_RESERVATION',
    title_de: 'Reservierung vorbereiten',
    description_de: 'Bereitet eine Einheitenreservierung für einen Käufer vor',
    zones: ['Z2'] as ArmstrongZone[],
    module: 'MOD-13',
    risk_level: 'low' as RiskLevel,
    execution_mode: 'draft_only' as ExecutionMode,
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['projects', 'units', 'contacts'],
    data_scopes_write: ['reservation_drafts'],
    side_effects: [],
    version: '1.0.0',
    cost_model: 'free' as CostModel,
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'internal' as const, endpoint: null },
    ui_entrypoints: ['/portal/projekte'],
    audit_event_type: 'ARM_MOD13_DRAFT_RESERVATION',
    status: 'active' as ActionStatus,
  },

  // ===========================================================================
  // MOD-17: CARS (Erweiterungen)
  // ===========================================================================
  {
    action_code: 'ARM.MOD17.EXPLAIN_MODULE',
    title_de: 'Fahrzeugmodul erklären',
    description_de: 'Erklärt die Fahrzeugverwaltung: Dossier, Wartung, Kosten',
    zones: ['Z2'] as ArmstrongZone[],
    module: 'MOD-17',
    risk_level: 'low' as RiskLevel,
    execution_mode: 'readonly' as ExecutionMode,
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['knowledge_base'],
    data_scopes_write: [],
    side_effects: [],
    version: '1.0.0',
    cost_model: 'free' as CostModel,
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'internal' as const, endpoint: null },
    ui_entrypoints: ['/portal/cars'],
    audit_event_type: 'ARM_MOD17_EXPLAIN',
    status: 'active' as ActionStatus,
  },
  {
    action_code: 'ARM.MOD17.CREATE_VEHICLE',
    title_de: 'Fahrzeug anlegen',
    description_de: 'Legt ein neues Fahrzeug mit Stammdaten an',
    zones: ['Z2'] as ArmstrongZone[],
    module: 'MOD-17',
    risk_level: 'low' as RiskLevel,
    execution_mode: 'execute_with_confirmation' as ExecutionMode,
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: [],
    data_scopes_write: ['vehicles'],
    side_effects: [],
    version: '1.0.0',
    cost_model: 'free' as CostModel,
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'internal' as const, endpoint: null },
    ui_entrypoints: ['/portal/cars'],
    audit_event_type: 'ARM_MOD17_CREATE_VEHICLE',
    status: 'active' as ActionStatus,
  },
  {
    action_code: 'ARM.MOD17.SCHEDULE_SERVICE',
    title_de: 'Wartungstermin planen',
    description_de: 'Plant einen Wartungs- oder TÜV-Termin für ein Fahrzeug',
    zones: ['Z2'] as ArmstrongZone[],
    module: 'MOD-17',
    risk_level: 'low' as RiskLevel,
    execution_mode: 'execute_with_confirmation' as ExecutionMode,
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['vehicles', 'calendar'],
    data_scopes_write: ['calendar', 'task_widgets'],
    side_effects: [],
    version: '1.0.0',
    cost_model: 'free' as CostModel,
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'internal' as const, endpoint: null },
    ui_entrypoints: ['/portal/cars'],
    audit_event_type: 'ARM_MOD17_SCHEDULE_SERVICE',
    status: 'active' as ActionStatus,
  },

  // ===========================================================================
  // MOD-18: FINANZEN (Erweiterungen)
  // ===========================================================================
  {
    action_code: 'ARM.MOD18.EXPLAIN_MODULE',
    title_de: 'Finanzmodul erklären',
    description_de: 'Erklärt die Privatfinanzen: Versicherungen, Abos, Investments',
    zones: ['Z2'] as ArmstrongZone[],
    module: 'MOD-18',
    risk_level: 'low' as RiskLevel,
    execution_mode: 'readonly' as ExecutionMode,
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['knowledge_base'],
    data_scopes_write: [],
    side_effects: [],
    version: '1.0.0',
    cost_model: 'free' as CostModel,
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'internal' as const, endpoint: null },
    ui_entrypoints: ['/portal/finanzen'],
    audit_event_type: 'ARM_MOD18_EXPLAIN',
    status: 'active' as ActionStatus,
  },
  {
    action_code: 'ARM.MOD18.EXPLAIN_INSURANCE',
    title_de: 'Versicherung erklären',
    description_de: 'Erklärt Versicherungstypen und ihre Relevanz für Immobilienbesitzer',
    zones: ['Z2'] as ArmstrongZone[],
    module: 'MOD-18',
    risk_level: 'low' as RiskLevel,
    execution_mode: 'readonly' as ExecutionMode,
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['knowledge_base'],
    data_scopes_write: [],
    side_effects: [],
    version: '1.0.0',
    cost_model: 'free' as CostModel,
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'internal' as const, endpoint: null },
    ui_entrypoints: ['/portal/finanzen'],
    audit_event_type: 'ARM_MOD18_EXPLAIN_INSURANCE',
    status: 'active' as ActionStatus,
  },
  {
    action_code: 'ARM.MOD18.SUBSCRIPTION_OVERVIEW',
    title_de: 'Abo-Übersicht erstellen',
    description_de: 'Erstellt eine Übersicht aller laufenden Abonnements und Verträge',
    zones: ['Z2'] as ArmstrongZone[],
    module: 'MOD-18',
    risk_level: 'low' as RiskLevel,
    execution_mode: 'readonly' as ExecutionMode,
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['subscriptions', 'contracts'],
    data_scopes_write: [],
    side_effects: [],
    version: '1.0.0',
    cost_model: 'free' as CostModel,
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'internal' as const, endpoint: null },
    ui_entrypoints: ['/portal/finanzen'],
    audit_event_type: 'ARM_MOD18_SUBSCRIPTION_OVERVIEW',
    status: 'active' as ActionStatus,
  },

  // ===========================================================================
  // MOD-05: PETS
  // ===========================================================================
  {
    action_code: 'ARM.MOD05.EXPLAIN_MODULE',
    title_de: 'Pets-Modul erklären',
    description_de: 'Erklärt die Tierverwaltung: Profile, Tierarzt, Dokumente',
    zones: ['Z2'] as ArmstrongZone[],
    module: 'MOD-05',
    risk_level: 'low' as RiskLevel,
    execution_mode: 'readonly' as ExecutionMode,
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['knowledge_base'],
    data_scopes_write: [],
    side_effects: [],
    version: '1.0.0',
    cost_model: 'free' as CostModel,
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'internal' as const, endpoint: null },
    ui_entrypoints: ['/portal/pets'],
    audit_event_type: 'ARM_MOD05_EXPLAIN',
    status: 'active' as ActionStatus,
  },
  {
    action_code: 'ARM.MOD05.CREATE_PET',
    title_de: 'Tier anlegen',
    description_de: 'Legt ein neues Tierprofil mit Stammdaten an',
    zones: ['Z2'] as ArmstrongZone[],
    module: 'MOD-05',
    risk_level: 'low' as RiskLevel,
    execution_mode: 'execute_with_confirmation' as ExecutionMode,
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: [],
    data_scopes_write: ['pets'],
    side_effects: [],
    version: '1.0.0',
    cost_model: 'free' as CostModel,
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'internal' as const, endpoint: null },
    ui_entrypoints: ['/portal/pets'],
    audit_event_type: 'ARM_MOD05_CREATE_PET',
    status: 'active' as ActionStatus,
  },
  {
    action_code: 'ARM.MOD05.SCHEDULE_VET',
    title_de: 'Tierarzttermin planen',
    description_de: 'Plant einen Tierarzttermin und erstellt eine Kalender-Erinnerung',
    zones: ['Z2'] as ArmstrongZone[],
    module: 'MOD-05',
    risk_level: 'low' as RiskLevel,
    execution_mode: 'execute_with_confirmation' as ExecutionMode,
    requires_consent_code: null,
    roles_allowed: [],
    data_scopes_read: ['pets', 'calendar'],
    data_scopes_write: ['calendar', 'task_widgets'],
    side_effects: [],
    version: '1.0.0',
    cost_model: 'free' as CostModel,
    cost_unit: null,
    cost_hint_cents: null,
    api_contract: { type: 'internal' as const, endpoint: null },
    ui_entrypoints: ['/portal/pets'],
    audit_event_type: 'ARM_MOD05_SCHEDULE_VET',
    status: 'active' as ActionStatus,
  },
];

// =============================================================================
// HELPER FUNCTIONS
// =============================================================================

/**
 * Get all actions available for a specific zone
 */
export function getActionsForZone(zone: ArmstrongZone): ArmstrongActionV2[] {
  return armstrongActions.filter(action => 
    action.zones.includes(zone) && action.status === 'active'
  );
}

/**
 * Get all actions for a specific module
 */
export function getActionsForModule(moduleCode: string): ArmstrongActionV2[] {
  return armstrongActions.filter(action => 
    action.module === moduleCode && action.status === 'active'
  );
}

/**
 * Get action by code
 */
export function getAction(actionCode: string): ArmstrongActionV2 | undefined {
  return armstrongActions.find(action => action.action_code === actionCode);
}

/**
 * Check if an action requires confirmation based on execution_mode
 */
export function requiresConfirmation(actionCode: string): boolean {
  const action = getAction(actionCode);
  if (!action) return true; // Default to safe
  return action.execution_mode === 'execute_with_confirmation' || 
         action.execution_mode === 'draft_only';
}

/**
 * Check if action is allowed in Zone 3 (global check)
 */
export function isZone3Action(actionCode: string): boolean {
  return ZONE3_ALLOWED_ACTION_CODES.includes(actionCode as Zone3ActionCode);
}

/**
 * Check if action is allowed for a specific Zone 3 persona (route-based)
 */
export function isActionAllowedForPersona(actionCode: string, route: string): boolean {
  const pack = getPersonaPack(route);
  if (!pack) return false;
  return pack.includes(actionCode as Zone3ActionCode);
}

/**
 * Get all metered actions (for billing dashboard)
 */
export function getMeteredActions(): ArmstrongActionV2[] {
  return armstrongActions.filter(action => action.cost_model === 'metered');
}

/**
 * Filter actions by role
 */
export function filterActionsByRole(
  actions: ArmstrongActionV2[], 
  userRoles: string[]
): ArmstrongActionV2[] {
  return actions.filter(action => {
    // Empty roles_allowed means all authenticated users can access
    if (action.roles_allowed.length === 0) return true;
    // Check if user has any of the required roles
    return action.roles_allowed.some(role => userRoles.includes(role));
  });
}

/**
 * Get actions by execution mode
 */
export function getActionsByExecutionMode(mode: ExecutionMode): ArmstrongActionV2[] {
  return armstrongActions.filter(action => action.execution_mode === mode);
}

/**
 * Get high-risk actions (for governance review)
 */
export function getHighRiskActions(): ArmstrongActionV2[] {
  return armstrongActions.filter(action => action.risk_level === 'high');
}

/**
 * Legacy compatibility: map requires_confirmation to execution_mode
 * @deprecated Use execution_mode directly
 */
export function getRequiresConfirmation(action: ArmstrongActionV2): boolean {
  return action.execution_mode === 'execute_with_confirmation';
}
